<!DOCTYPE html>
<!--
üéâ OTIMIZA√á√ïES IMPLEMENTADAS EM DEZEMBRO 2024:
‚úÖ Bot√µes reduzidos para tamanhos mais compactos
‚úÖ Painel de informa√ß√µes otimizado (~40% menor)
‚úÖ Informa√ß√µes secund√°rias ocultas no mobile (Velocidade, Tempo, Pontos)
‚úÖ Responsividade aprimorada para Desktop/Tablet/Mobile
‚úÖ RESPONSIVIDADE VERTICAL CORRIGIDA:
   üìê C√°lculo din√¢mico de altura dispon√≠vel
   üéÆ Canvas ajusta automaticamente ao espa√ßo
   üè∞ Torres n√£o s√£o mais cortadas na parte inferior
   üîÑ Sistema de reajuste autom√°tico no resize
   üì± Otimiza√ß√£o espec√≠fica por tipo de dispositivo
‚úÖ Fun√ß√µes de teste integradas para verifica√ß√£o completa
-->
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tower Defense</title>
    <link rel="icon" type="image/x-icon" href="assets/imagen/favicon.ico">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="skill-tree.css">
    <link rel="stylesheet" href="config-style.css">
</head>
<body>
    <div class="game-container">
        <div class="top-panel">
            <div class="stats">
                <div class="stat">
                    <span class="label">Vida:</span>
                    <span id="health" class="value">20</span>
                </div>
                <div class="stat">
                    <span class="label">Ouro:</span>
                    <span id="gold" class="value">100</span>
                </div>
                <div class="stat">
                    <span class="label">Onda:</span>
                    <span id="wave" class="value">1</span>
                </div>
                <div class="stat">
                    <span class="label">Monstros:</span>
                    <span id="monsters" class="value">0/0</span>
                </div>
                <div class="stat">
                    <span class="label">Tempo:</span>
                    <span id="gameTime" class="value">00:00</span>
                </div>
                <div class="stat">
                    <span class="label">Pr√≥xima Onda:</span>
                    <span id="nextWaveTimer" class="value">--</span>
                </div>
                <div class="stat">
                    <span class="label">Pontos:</span>
                    <span id="score" class="value">0</span>
                </div>
                <div class="stat">
                    <span class="label">Velocidade:</span>
                    <span id="gameSpeed" class="value">1x</span>
            </div>
        </div>
            <!-- Barra de controles -->
            <div class="horizontal-controls">
                <button id="start-wave" class="control-btn" title="Iniciar pr√≥xima onda">
                    <span class="btn-icon">‚ñ∂Ô∏è</span>
                    <span class="btn-text">PR√ìXIMA ONDA</span>
                </button>
                <button id="pause" class="control-btn" title="Pausar/Continuar jogo">
                    <span class="btn-icon">‚è∏Ô∏è</span>
                    <span class="btn-text">Continuar</span>
                </button>
                <button id="speedButton" class="control-btn speed-btn" title="Alterar velocidade do jogo (1x)">
                    <span class="btn-icon">‚ö°</span>
                    <span class="btn-text">1x</span>
                </button>
                <a href="config.html" class="control-btn config-btn" title="Configura√ß√µes do jogo">
                    <span class="btn-icon">‚öôÔ∏è</span>
                    <span class="btn-text">Configura√ß√£o</span>
                </a>
                <button id="btnUpgrades" class="control-btn upgrade-btn" title="√Årvore de habilidades">
                    <span class="btn-icon">‚≠ê</span>
                    <span class="btn-text">Upgrades</span>
                </button>
                <button id="btnBackToMenu" class="control-btn menu-btn" title="Voltar ao menu principal">
                    <span class="btn-icon">üè†</span>
                    <span class="btn-text">Menu Principal</span>
                </button>
            </div>
        </div>
        
        <div class="game-content">
            <canvas id="gameCanvas"></canvas>
        <div class="game-over" id="gameOver" style="display: none;">
            <div class="game-over-content">
                <h2>Game Over!</h2>
                <p>Voc√™ sobreviveu a <span id="final-wave">0</span> ondas!</p>
                <button id="restart" class="btn">Voltar ao Menu</button>
            </div>
        </div>

        <!-- Painel de informa√ß√µes da torre -->
        <div class="tower-info-panel" id="towerInfoPanel" style="display: none;">
            <div class="tower-info-content">
                <h3 id="towerInfoTitle">Informa√ß√µes da Torre</h3>
                <div class="tower-stats">
                    <div class="stat">
                        <span class="label">N√≠vel:</span>
                        <span id="towerLevel">1</span>
                    </div>
                    <div class="stat">
                        <span class="label">Dano:</span>
                        <span id="towerDamage">15</span>
                    </div>
                    <div class="stat">
                        <span class="label">Alcance:</span>
                        <span id="towerRange">120</span>
                    </div>
                    <div class="stat">
                        <span class="label">Taxa de Tiro:</span>
                        <span id="towerFireRate">1000ms</span>
                    </div>
                </div>
                <div class="tower-actions">
                    <button id="upgradeTower" class="btn btn-success">‚¨ÜÔ∏è Evoluir (<span id="upgradeCost">50</span>)</button>
                    <button id="sellTower" class="btn btn-danger">üí∞ Vender (<span id="sellValue">25</span>)</button>
                    <button id="closeTowerInfo" class="btn btn-secondary">‚ùå Fechar</button>
                </div>
                </div>
            </div>
        </div>

        <!-- Container para as habilidades especiais -->
        <div id="specialSkillsFixedBar" class="skills-container">
            <button id="btnArrowRain" class="special-skill-btn" title="Chuva de Flechas">
                <span class="skill-icon">üèπ</span>
                <span class="skill-label">Chuva de Flechas</span>
                <span class="skill-cooldown" id="arrowRainCooldown"></span>
            </button>
            <button id="btnIceStorm" class="special-skill-btn" title="Tempestade de Gelo">
                <span class="skill-icon">‚ùÑÔ∏è</span>
                <span class="skill-label">Tempestade de Gelo</span>
                <span class="skill-cooldown" id="iceStormCooldown"></span>
            </button>
        </div>

        <div class="footer-tower-bar" id="footerTowerBar">
            <!-- As op√ß√µes de torres ser√£o geradas dinamicamente pelo JS -->
        </div>
    </div>
    
    <script src="game.js" type="module"></script>
    <script src="config.js" type="module"></script>
    <!-- <script src="debug-layout.js"></script> DEBUG TEMPORARIAMENTE DESABILITADO PARA CORRIGIR MENU -->

    <div id="infoTooltip" class="info-tooltip" style="display:none;"></div>
    


    <!-- Painel/modal de upgrades -->
    <div id="upgradeModal" class="upgrade-modal" style="display:none;">
        <div class="upgrade-modal-content">
            <span id="closeUpgradeModal" class="close-modal">&times;</span>
            <h2>Upgrades Globais</h2>
            <div id="upgradePointsInfo">Pontos dispon√≠veis: <span id="upgradePoints">0</span></div>
            <div id="upgradeList"></div>
        </div>
    </div>

    <div id="mainMenu" class="main-menu-overlay">
        <div class="main-menu-content">
            <h1 class="main-menu-title">Tower Defense</h1>
            <p style="color: #4fdfff; text-align: center; margin-bottom: 20px; font-size: 1.1em;">
                Modo Infinito - Sobreviva o m√°ximo de ondas poss√≠vel!
            </p>
            <button id="btnPlay" class="main-menu-btn">Jogar</button>
            <button id="btnContinue" class="main-menu-btn btn-continue" style="display: none;">Continuar</button>
            <button id="btnMenuConfig" class="main-menu-btn">Configura√ß√µes</button>
            <button id="btnMenuCredits" class="main-menu-btn">Cr√©ditos</button>
        </div>
    </div>

    <div id="creditsModal" class="main-menu-modal" style="display:none;">
        <div class="main-menu-modal-content">
            <span id="closeCreditsModal" class="main-menu-close">&times;</span>
            <h2>Cr√©ditos</h2>
            <p>Desenvolvido por [Seu Nome ou Equipe].<br>Inspirado em cl√°ssicos do g√™nero Tower Defense.<br><br>Projeto open-source para fins de estudo e divers√£o.</p>
        </div>
    </div>

    <style>
    /* NOVO LAYOUT REORGANIZADO */
    
    /* Estrutura otimizada para novo layout */
    .game-content {
        flex-grow: 1 !important;
        position: relative !important;
        width: 100% !important;
        display: flex !important;
        flex-direction: column !important;
        padding: 10px !important;
    }
    
    /* Canvas otimizado para nova estrutura */
    #gameCanvas {
        margin: 0 auto !important;
        display: block !important;
        position: relative !important;
        z-index: 1 !important;
        background: #0a0e17 !important;
        border-radius: 8px !important;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
    }
    
    /* Barra horizontal de controles */
    .horizontal-controls {
        display: flex !important;
        justify-content: center !important;
        align-items: center !important;
        gap: 6px !important;
        padding: 10px 16px !important;
        background: rgba(15, 23, 42, 0.95) !important;
        border-bottom: 2px solid rgba(99, 102, 241, 0.3) !important;
        backdrop-filter: blur(20px) !important;
        flex-wrap: nowrap !important;
        overflow-x: auto !important;
        overflow-y: hidden !important;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
    }
    
    .control-btn {
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 3px !important;
        padding: 8px 12px !important;
        border: 2px solid rgba(255, 255, 255, 0.1) !important;
        border-radius: 12px !important;
        background: linear-gradient(135deg, rgba(51, 65, 85, 0.9), rgba(71, 85, 105, 0.9)) !important;
        color: white !important;
        font-size: 13px !important;
        font-weight: 600 !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
        text-decoration: none !important;
        min-width: 100px !important;
        max-width: 100px !important;
        height: 55px !important;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2) !important;
        flex-shrink: 0 !important;
    }
    
    /* Scroll horizontal suave para a barra de controles */
    .horizontal-controls::-webkit-scrollbar {
        height: 4px !important;
    }
    
    .horizontal-controls::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1) !important;
        border-radius: 2px !important;
    }
    
    .horizontal-controls::-webkit-scrollbar-thumb {
        background: rgba(99, 102, 241, 0.6) !important;
        border-radius: 2px !important;
    }
    
    .horizontal-controls::-webkit-scrollbar-thumb:hover {
        background: rgba(99, 102, 241, 0.8) !important;
    }
    
    .control-btn:hover {
        transform: translateY(-3px) scale(1.05) !important;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4) !important;
        border-color: rgba(255, 255, 255, 0.3) !important;
    }
    
    .control-btn:active {
        transform: translateY(-1px) scale(1.02) !important;
    }
    
    /* Estilos espec√≠ficos por tipo de bot√£o */
    .control-btn#start-wave {
        background: linear-gradient(135deg, #6366f1, #4338ca) !important;
        border-color: rgba(99, 102, 241, 0.3) !important;
    }
    
    .control-btn#start-wave:hover {
        background: linear-gradient(135deg, #4338ca, #3730a3) !important;
        box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4) !important;
    }
    
    .control-btn#pause {
        background: linear-gradient(135deg, #64748b, #475569) !important;
        border-color: rgba(100, 116, 139, 0.3) !important;
    }
    
    .control-btn#pause:hover {
        background: linear-gradient(135deg, #475569, #334155) !important;
        box-shadow: 0 8px 25px rgba(100, 116, 139, 0.4) !important;
    }
    
    .control-btn.speed-btn {
        background: linear-gradient(135deg, #10b981, #047857) !important;
        border-color: rgba(16, 185, 129, 0.3) !important;
    }
    
    .control-btn.speed-btn:hover {
        background: linear-gradient(135deg, #047857, #065f46) !important;
        box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4) !important;
    }
    
    .control-btn.config-btn {
        background: linear-gradient(135deg, #8b5cf6, #7c3aed) !important;
        border-color: rgba(139, 92, 246, 0.3) !important;
    }
    
    .control-btn.config-btn:hover {
        background: linear-gradient(135deg, #7c3aed, #6d28d9) !important;
        box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4) !important;
    }
    
    .control-btn.upgrade-btn {
        background: linear-gradient(135deg, #f59e0b, #d97706) !important;
        border-color: rgba(245, 158, 11, 0.3) !important;
    }
    
    .control-btn.upgrade-btn:hover {
        background: linear-gradient(135deg, #d97706, #b45309) !important;
        box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4) !important;
    }
    
    .control-btn.menu-btn {
        background: linear-gradient(135deg, #6b7280, #4b5563) !important;
        border-color: rgba(107, 114, 128, 0.3) !important;
    }
    
    .control-btn.menu-btn:hover {
        background: linear-gradient(135deg, #4b5563, #374151) !important;
        box-shadow: 0 8px 25px rgba(107, 114, 128, 0.4) !important;
    }
    
    .control-btn .btn-icon {
        font-size: 18px !important;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3)) !important;
    }
    
    .control-btn .btn-text {
        font-size: 10px !important;
        font-weight: 700 !important;
        text-transform: uppercase !important;
        letter-spacing: 0.3px !important;
        text-align: center !important;
        line-height: 1.1 !important;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
    }
    
    /* Controlar menu principal */
    #mainMenu {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        z-index: 10000 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        background: linear-gradient(135deg, #181c24 80%, #4fdfff 100%) !important;
    }
    
    /* Esconder o menu quando o jogo est√° rodando */
    body.game-running #mainMenu {
        display: none !important;
    }
    
    /* Habilidades especiais centralizadas entre canvas e torres */
    #specialSkillsFixedBar,
    .skills-container {
        display: flex !important;
        justify-content: center !important;
        align-items: center !important;
        gap: 20px !important;
        padding: 15px 20px !important;
        background: rgba(30, 41, 59, 0.5) !important;
        border-top: 1px solid rgba(255, 255, 255, 0.1) !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
        margin: 10px 0 !important;
    }
    
    #btnArrowRain {
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 4px !important;
        width: 150px !important;
        height: 80px !important;
        background: linear-gradient(135deg, #e74c3c, #c0392b) !important;
        border: 2px solid rgba(255, 255, 255, 0.2) !important;
        border-radius: 12px !important;
        color: white !important;
        font-weight: 600 !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3) !important;
    }
    
    #btnArrowRain:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4) !important;
    }
    
    #btnIceStorm {
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 4px !important;
        width: 150px !important;
        height: 80px !important;
        background: linear-gradient(135deg, #3498db, #2980b9) !important;
        border: 2px solid rgba(255, 255, 255, 0.2) !important;
        border-radius: 12px !important;
        color: white !important;
        font-weight: 600 !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3) !important;
    }
    
    #btnIceStorm:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4) !important;
    }
    
    .special-skill-btn .skill-icon {
        font-size: 2em !important;
        margin-bottom: 4px !important;
    }
    
    .special-skill-btn .skill-label {
        font-size: 0.75em !important;
        font-weight: 600 !important;
        text-align: center !important;
        line-height: 1.2 !important;
    }
    
    .special-skill-btn .skill-cooldown {
        font-size: 0.8em !important;
        color: #ff6b6b !important;
        font-weight: 700 !important;
        margin-top: 2px !important;
    }
    
    /* Responsividade para tablets */
    @media (max-width: 768px) {
        .horizontal-controls {
            gap: 6px !important;
            padding: 10px 15px !important;
        }
        
        .control-btn {
            min-width: 85px !important;
            max-width: 85px !important;
            height: 50px !important;
            padding: 8px 10px !important;
        }
        
        .control-btn .btn-icon {
            font-size: 16px !important;
        }
        
        .control-btn .btn-text {
            font-size: 9px !important;
        }
        
        #btnArrowRain, #btnIceStorm {
            width: 120px !important;
            height: 60px !important;
        }
        
        #specialSkillsFixedBar,
        .skills-container {
            gap: 10px !important;
            padding: 10px !important;
        }
    }
    
    /* Responsividade para celular - APENAS √çCONES */
    @media (max-width: 480px) {
        .horizontal-controls {
            gap: 4px !important;
            padding: 8px 10px !important;
            justify-content: space-evenly !important;
        }
        
        .control-btn {
            min-width: 48px !important;
            max-width: 48px !important;
            height: 48px !important;
            padding: 6px 4px !important;
            border-radius: 50% !important;
            flex-direction: column !important;
            gap: 1px !important;
        }
        
        .control-btn .btn-icon {
            font-size: 16px !important;
        }
        
        /* ESCONDER TEXTO NO CELULAR - S√ì √çCONES */
        .control-btn .btn-text {
            display: none !important;
        }
        
        /* Exce√ß√£o para o bot√£o de velocidade - mostrar valor */
        .control-btn.speed-btn .btn-text {
            display: block !important;
            font-size: 9px !important;
            font-weight: 800 !important;
            margin-top: -2px !important;
        }
        
        .control-btn.speed-btn .btn-icon {
            font-size: 14px !important;
        }
        
        /* Habilidades especiais menores no celular */
        #btnArrowRain, #btnIceStorm {
            width: 100px !important;
            height: 50px !important;
        }
        
        .special-skill-btn .skill-icon {
            font-size: 1.5em !important;
        }
        
        .special-skill-btn .skill-label {
            font-size: 0.6em !important;
        }
        
        /* Tooltips para bot√µes no celular */
        .control-btn {
            position: relative !important;
        }
        
        .control-btn:hover::before {
            content: attr(title) !important;
            position: absolute !important;
            bottom: 120% !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            background: rgba(0, 0, 0, 0.9) !important;
            color: white !important;
            padding: 4px 8px !important;
            border-radius: 6px !important;
            font-size: 10px !important;
            white-space: nowrap !important;
            z-index: 1000 !important;
            animation: tooltipShow 0.2s ease !important;
        }
        
        .control-btn:hover::after {
            content: '' !important;
            position: absolute !important;
            bottom: 115% !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            border: 3px solid transparent !important;
            border-top-color: rgba(0, 0, 0, 0.9) !important;
            z-index: 1000 !important;
        }
    }
    
    @keyframes tooltipShow {
        from {
            opacity: 0;
            transform: translateX(-50%) translateY(4px);
        }
        to {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
    }
    
    /* Estilos visuais melhorados para o menu principal */
    .main-menu-overlay {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%) !important;
        backdrop-filter: blur(10px) !important;
    }
    
        .main-menu-content {
        background: rgba(30, 41, 59, 0.95) !important;
        border: 2px solid rgba(79, 223, 255, 0.3) !important;
        border-radius: 20px !important;
        padding: 50px 40px !important;
        box-shadow: 
            0 25px 50px -12px rgba(0, 0, 0, 0.8),
            0 0 100px rgba(79, 223, 255, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
        backdrop-filter: blur(20px) !important;
        max-width: 450px !important;
        width: 90% !important;
        animation: menuSlideIn 0.6s ease-out !important;
        }
        
        .main-menu-title {
        font-size: 3em !important;
        font-weight: 900 !important;
        background: linear-gradient(135deg, #4fdfff 0%, #06b6d4 50%, #0891b2 100%) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
        text-align: center !important;
        margin-bottom: 10px !important;
        text-shadow: 0 4px 20px rgba(79, 223, 255, 0.3) !important;
        letter-spacing: 2px !important;
        }
        
        .main-menu-btn {
        width: 100% !important;
        padding: 18px 30px !important;
        margin: 12px 0 !important;
        background: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #60a5fa 100%) !important;
        border: 2px solid rgba(59, 130, 246, 0.3) !important;
        border-radius: 12px !important;
        color: white !important;
        font-size: 1.2em !important;
        font-weight: 700 !important;
        cursor: pointer !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        text-transform: uppercase !important;
        letter-spacing: 1px !important;
        position: relative !important;
        overflow: hidden !important;
        box-shadow: 
            0 10px 20px rgba(30, 64, 175, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
    }
    
    .main-menu-btn::before {
        content: '' !important;
        position: absolute !important;
        top: 0 !important;
        left: -100% !important;
        width: 100% !important;
        height: 100% !important;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent) !important;
        transition: left 0.6s ease !important;
    }
    
    .main-menu-btn:hover::before {
        left: 100% !important;
    }
    
    .main-menu-btn:hover {
        background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 50%, #93c5fd 100%) !important;
        border-color: rgba(96, 165, 250, 0.6) !important;
        transform: translateY(-3px) scale(1.02) !important;
        box-shadow: 
            0 20px 40px rgba(59, 130, 246, 0.4),
            0 0 30px rgba(79, 223, 255, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.3) !important;
        }
        
        .btn-continue {
        background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%) !important;
        border-color: rgba(16, 185, 129, 0.3) !important;
        box-shadow: 
            0 10px 20px rgba(5, 150, 105, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
    }
    
    .btn-continue:hover {
        background: linear-gradient(135deg, #10b981 0%, #34d399 50%, #6ee7b7 100%) !important;
        border-color: rgba(52, 211, 153, 0.6) !important;
        box-shadow: 
            0 20px 40px rgba(16, 185, 129, 0.4),
            0 0 30px rgba(52, 211, 153, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.3) !important;
    }
    
    @keyframes menuSlideIn {
        from {
            opacity: 0;
            transform: translateY(-50px) scale(0.9);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }
    
    /* Estilos para dispositivos m√≥veis */
    @media (max-width: 768px) {
        .main-menu-content {
            padding: 40px 30px !important;
            max-width: 350px !important;
        }
        
        .main-menu-title {
            font-size: 2.5em !important;
        }
        
        .main-menu-btn {
            padding: 16px 25px !important;
            font-size: 1.1em !important;
        }
    }
    
    @media (max-width: 480px) {
        .main-menu-content {
            padding: 30px 20px !important;
            max-width: 300px !important;
            margin: 20px !important;
        }
        
        .main-menu-title {
            font-size: 2em !important;
        }
        
        .main-menu-btn {
            padding: 14px 20px !important;
            font-size: 1em !important;
        }
    }
    </style>

    <script>
    // Fun√ß√µes de debug globais
    window.debugMode = false;
    window.toggleDebug = function() {
        window.debugMode = !window.debugMode;
        console.log(`Modo debug ${window.debugMode ? 'ativado' : 'desativado'}`);
        
        // Atualizar texto do bot√£o
        const debugButton = document.getElementById('debugButton');
        if (debugButton) {
            debugButton.textContent = `Debug: ${window.debugMode ? 'ON' : 'OFF'}`;
            debugButton.style.background = window.debugMode ? '#ff6600' : '#333';
        }
        
        if (window.debugMode) {
            console.log('Para testar a explos√£o do canh√£o, coloque uma torre canh√£o e observe os logs no console');
            console.log('Use testExplosion(x, y, radius) para testar explos√µes manualmente');
        }
    };

    // Fun√ß√£o para testar explos√£o manualmente
    window.testExplosion = function(x, y, radius) {
        if (!window.gameSystem || !window.gameSystem.gameState) {
            console.log('Sistema de jogo n√£o inicializado');
            return;
        }
        
        console.log(`Testando explos√£o em (${x}, ${y}) com raio ${radius}`);
        
        // Simular uma explos√£o
        let hitCount = 0;
        const enemies = [...window.gameSystem.gameState.enemies];
        
        for (let enemy of enemies) {
            if (!enemy || !enemy.health || enemy.health <= 0 || enemy.isRemoved) continue;
            
            const dx = enemy.x - x;
            const dy = enemy.y - y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance <= radius) {
                hitCount++;
                console.log(`‚úÖ Teste: inimigo atingido a ${distance.toFixed(1)}px`);
            } else {
                console.log(`‚ùå Teste: inimigo fora da √°rea (${distance.toFixed(1)}px > ${radius}px)`);
            }
        }
        
        console.log(`üéØ Teste: ${hitCount} inimigos seriam atingidos`);
    };

    // Fun√ß√£o para testar o bot√£o "Continuar"
    window.testContinuarButton = function(onda = 5) {
        // Simular progresso
        localStorage.setItem('maiorOndaAtingida', onda.toString());
        console.log(`Progresso simulado: Onda ${onda} salva`);
        
        // Atualizar bot√£o
        if (typeof window.adicionarBotaoContinuarMenu !== 'undefined') {
            window.adicionarBotaoContinuarMenu();
            console.log('Bot√£o "Continuar" atualizado');
        }
        
        // Mostrar status
        const btn = document.getElementById('btnContinue');
        if (btn) {
            console.log('Bot√£o encontrado. Vis√≠vel:', btn.style.display);
            console.log('Conte√∫do HTML:', btn.innerHTML);
        }
    };

    // Fun√ß√£o para testar responsividade
    window.testResponsividade = function() {
        const info = {
            tela: `${window.innerWidth}x${window.innerHeight}`,
            dispositivo: window.innerWidth <= 480 ? 'Celular' : window.innerWidth <= 768 ? 'Tablet' : 'Desktop',
            canvas: document.getElementById('gameCanvas'),
            orientacao: window.innerHeight > window.innerWidth ? 'Retrato' : 'Paisagem'
        };
        
        console.log('üì± Teste de Responsividade:', info);
        
        if (info.canvas) {
            console.log('Canvas:', {
                dimensaoInterna: `${info.canvas.width}x${info.canvas.height}`,
                dimensaoCSS: `${info.canvas.style.width} x ${info.canvas.style.height}`,
                visivel: info.canvas.offsetWidth > 0
            });
        }
        
        return info;
    };

    // Fun√ß√£o global para controlar o menu principal
    window.hideMainMenu = function() {
        const menu = document.getElementById('mainMenu');
        if (menu) {
            menu.style.display = 'none';
            document.body.classList.add('game-running');
            console.log('üéÆ Menu principal escondido programaticamente');
        }
    };
    
    window.showMainMenu = function() {
        const menu = document.getElementById('mainMenu');
        if (menu) {
            menu.style.display = 'flex';
            document.body.classList.remove('game-running');
            console.log('üìã Menu principal mostrado programaticamente');
        }
    };
    
    window.returnToMenu = function(confirmFirst = true) {
        let shouldReturn = true;
        
        if (confirmFirst) {
            shouldReturn = confirm('Deseja voltar ao menu principal? O progresso atual ser√° perdido.');
        }
        
        if (shouldReturn) {
            // Pausar o jogo se estiver rodando
            if (window.gameSystem && !window.gameSystem.gameState.isPaused) {
                window.gameSystem.togglePause();
            }
            
            // Mostrar o menu principal
            window.showMainMenu();
            console.log('üè† Retornando ao menu principal');
            
            return true;
        }
        
        return false;
    };
    
    // Fun√ß√£o para verificar se o menu est√° sendo mostrado quando n√£o deveria
    window.checkMenuState = function() {
        const menu = document.getElementById('mainMenu');
        const isGameRunning = document.body.classList.contains('game-running');
        const gameSystem = window.gameSystem;
        
        console.log('üìã VERIFICA√á√ÉO DO ESTADO DO MENU:');
        console.log('  Menu display:', menu ? menu.style.display : 'elemento n√£o encontrado');
        console.log('  Classe game-running:', isGameRunning);
        console.log('  GameSystem rodando:', gameSystem ? gameSystem.isRunning : 'n√£o encontrado');
        
        // APENAS REPORTAR O ESTADO - N√ÉO ESCONDER AUTOMATICAMENTE
        return {
            menuVisible: menu ? menu.style.display !== 'none' : false,
            gameRunning: isGameRunning,
            gameSystemRunning: gameSystem ? gameSystem.isRunning : false
        };
    };

    // Menu inicial
    document.addEventListener('DOMContentLoaded', function() {
        const menu = document.getElementById('mainMenu');
        const btnPlay = document.getElementById('btnPlay');
        const btnContinue = document.getElementById('btnContinue');
        const btnConfig = document.getElementById('btnMenuConfig');
        const btnCredits = document.getElementById('btnMenuCredits');
        const creditsModal = document.getElementById('creditsModal');
        const closeCreditsModal = document.getElementById('closeCreditsModal');
        const debugButton = document.getElementById('debugButton');

        // Bot√£o de debug
        if (debugButton) {
            debugButton.addEventListener('click', function() {
                window.toggleDebug();
            });
        }

        // Ao clicar em Jogar, esconde o menu e inicia um novo jogo
        btnPlay.onclick = function() {
            document.body.classList.add('game-running');
            console.log('üéÆ Novo jogo iniciado - menu escondido e classe game-running adicionada');
            
            // Iniciar novo jogo usando fun√ß√£o dedicada
            if (typeof window.iniciarNovoJogo !== 'undefined') {
                window.iniciarNovoJogo();
            } else {
                console.log('Fun√ß√£o iniciarNovoJogo n√£o encontrada - usando fallback');
                // Fallback: esconder menu e iniciar game loop b√°sico
            menu.style.display = 'none';
            if (typeof window.gameSystem !== 'undefined' && window.gameSystem && !window.gameSystem.isRunning) {
                window.gameSystem.startGameLoop();
            } else if (typeof gameSystem !== 'undefined' && gameSystem && !gameSystem.isRunning) {
                gameSystem.startGameLoop();
                }
            }
        };
        
        // Ao clicar em Continuar, esconde o menu e inicia o modo continuar
        btnContinue.onclick = function() {
            menu.style.display = 'none';
            document.body.classList.add('game-running');
            console.log('üéÆ Modo continuar iniciado - menu escondido e classe game-running adicionada');
            
            if (typeof window.iniciarModoContinuar !== 'undefined') {
                window.iniciarModoContinuar();
            } else {
                console.log('Fun√ß√£o iniciarModoContinuar n√£o encontrada');
            }
        };
        
        // Verificar se deve mostrar o bot√£o "Continuar" (com delay para garantir que game.js foi carregado)
        setTimeout(function() {
            if (typeof window.adicionarBotaoContinuarMenu !== 'undefined') {
                window.adicionarBotaoContinuarMenu();
            }
        }, 100);
        // Configura√ß√µes: vai para config.html
        btnConfig.onclick = function() {
            window.location.href = 'config.html';
        };
        // Cr√©ditos: mostra modal
        btnCredits.onclick = function() {
            creditsModal.style.display = 'flex';
        };
        closeCreditsModal.onclick = function() {
            creditsModal.style.display = 'none';
        };
        // Fechar modal ao clicar fora
        creditsModal.onclick = function(e) {
            if (e.target === creditsModal) creditsModal.style.display = 'none';
        };
        
        // Bot√£o Voltar ao Menu
        const btnBackToMenu = document.getElementById('btnBackToMenu');
        if (btnBackToMenu) {
                         btnBackToMenu.onclick = function() {
                 window.returnToMenu(true);
             };
        }
    });

    // Script para garantir que o menu principal apare√ßa ao carregar
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üîß Aplicando novo layout reorganizado...');
        
        // GARANTIR QUE O MENU PRINCIPAL ESTEJA VIS√çVEL AO CARREGAR A P√ÅGINA
        const mainMenu = document.getElementById('mainMenu');
        if (mainMenu) {
            // Sempre mostrar o menu ao carregar a p√°gina
            mainMenu.style.display = 'flex';
            document.body.classList.remove('game-running');
            console.log('üìã Menu principal garantido como vis√≠vel ao carregar p√°gina');
        }
        
        // Garantir que as habilidades especiais estejam vis√≠veis
        const arrowBtn = document.getElementById('btnArrowRain');
        const iceBtn = document.getElementById('btnIceStorm');
        
        if (arrowBtn) arrowBtn.style.display = 'flex';
        if (iceBtn) iceBtn.style.display = 'flex';
        
        // Garantir que os event listeners sejam configurados ap√≥s um delay
        setTimeout(() => {
            if (typeof window.fixEventListeners === 'function') {
                window.fixEventListeners();
            }
        }, 1000);
        
        console.log('üéØ Novo layout reorganizado aplicado com sucesso!');
    });

    // Fun√ß√£o para testar o novo layout reorganizado
    window.testNewLayout = function() {
        console.log('üß™ TESTANDO NOVO LAYOUT REORGANIZADO');
        console.log('====================================');
        
        const elements = {
            topPanel: document.querySelector('.top-panel'),
            horizontalControls: document.querySelector('.horizontal-controls'),
            canvas: document.getElementById('gameCanvas'),
            skillsBar: document.getElementById('specialSkillsFixedBar'),
            towerBar: document.querySelector('.footer-tower-bar'),
            arrowBtn: document.getElementById('btnArrowRain'),
            iceBtn: document.getElementById('btnIceStorm')
        };
        
        console.log('üìã Verifica√ß√£o dos elementos:');
        Object.entries(elements).forEach(([name, element]) => {
            const exists = element !== null;
            const visible = element && element.offsetWidth > 0;
            console.log(`   ${name}: ${exists ? '‚úÖ' : '‚ùå'} Existe | ${visible ? '‚úÖ' : '‚ùå'} Vis√≠vel`);
        });
        
        // Verificar posicionamento
        if (elements.canvas) {
            const canvasRect = elements.canvas.getBoundingClientRect();
            console.log('üéØ Posicionamento do Canvas:');
            console.log(`   Left: ${canvasRect.left}px (deveria estar centralizado)`);
            console.log(`   Top: ${canvasRect.top}px`);
            console.log(`   Width: ${canvasRect.width}px`);
        }
        
        // Verificar barra de controles
        if (elements.horizontalControls) {
            const controlsRect = elements.horizontalControls.getBoundingClientRect();
            console.log('üéÆ Barra de Controles:');
            console.log(`   Top: ${controlsRect.top}px (abaixo da barra superior)`);
            console.log(`   Width: ${controlsRect.width}px (largura total)`);
            
            const buttons = elements.horizontalControls.querySelectorAll('.control-btn');
            console.log(`   Bot√µes encontrados: ${buttons.length}/6`);
        }
        
        // Verificar habilidades especiais
        if (elements.skillsBar) {
            const skillsRect = elements.skillsBar.getBoundingClientRect();
            console.log('üèπ Habilidades Especiais:');
            console.log(`   Top: ${skillsRect.top}px (entre canvas e torres)`);
            console.log(`   Centralizado: ${Math.abs(skillsRect.left + skillsRect.width/2 - window.innerWidth/2) < 50 ? '‚úÖ' : '‚ùå'}`);
        }
        
        // Verificar responsividade
        const screenWidth = window.innerWidth;
        console.log('üì± Responsividade:');
        console.log(`   Largura da tela: ${screenWidth}px`);
        console.log(`   Tipo: ${screenWidth <= 480 ? 'Mobile' : screenWidth <= 768 ? 'Tablet' : 'Desktop'}`);
        
        return elements;
    };
    
    // Executar teste automaticamente ap√≥s 2 segundos (tempo para o jogo carregar)
    setTimeout(() => {
        if (typeof window.testNewLayout === 'function') {
            window.testNewLayout();
        }
    }, 2000);

    // Fun√ß√£o para testar todas as funcionalidades ap√≥s as mudan√ßas
    window.testAllFunctions = function() {
        console.log('üîß TESTE COMPLETO DAS FUNCIONALIDADES');
        console.log('====================================');
        
        const tests = {};
        
        // Testar elementos b√°sicos
        tests.gameCanvas = document.getElementById('gameCanvas') !== null;
        tests.skillsContainer = document.getElementById('specialSkillsFixedBar') !== null;
        tests.skillsContainerClass = document.querySelector('.skills-container') !== null;
        tests.arrowRainBtn = document.getElementById('btnArrowRain') !== null;
        tests.iceStormBtn = document.getElementById('btnIceStorm') !== null;
        tests.speedButton = document.getElementById('speedButton') !== null;
        tests.towerBar = document.querySelector('.footer-tower-bar') !== null;
        tests.horizontalControls = document.querySelector('.horizontal-controls') !== null;
        
        // Testar event listeners
        const arrowBtn = document.getElementById('btnArrowRain');
        const iceBtn = document.getElementById('btnIceStorm');
        const speedBtn = document.getElementById('speedButton');
        
        tests.arrowRainClickable = arrowBtn && (arrowBtn.onclick !== null || arrowBtn._arrowRainHandler !== undefined);
        tests.iceStormClickable = iceBtn && (iceBtn.onclick !== null || iceBtn._iceStormHandler !== undefined);
        tests.speedButtonClickable = speedBtn && (speedBtn.onclick !== null || speedBtn._speedHandler !== undefined);
        
        // Testar visibilidade
        tests.arrowRainVisible = arrowBtn && arrowBtn.offsetWidth > 0;
        tests.iceStormVisible = iceBtn && iceBtn.offsetWidth > 0;
        tests.speedButtonVisible = speedBtn && speedBtn.offsetWidth > 0;
        
        // Testar layout
        const skillsBar = document.getElementById('specialSkillsFixedBar');
        if (skillsBar) {
            const skillsRect = skillsBar.getBoundingClientRect();
            tests.skillsBarPositioned = skillsRect.width > 0 && skillsRect.height > 0;
            tests.skillsBarCentered = Math.abs(skillsRect.left + skillsRect.width/2 - window.innerWidth/2) < 100;
        }
        
        // Testar GameSystem
        tests.gameSystemExists = typeof window.gameSystem !== 'undefined';
        tests.gameSystemInitialized = window.gameSystem && typeof window.gameSystem.toggleGameSpeed === 'function';
        
        // Testar fun√ß√µes globais
        tests.returnToMenuFunction = typeof window.returnToMenu === 'function';
        tests.testNewLayoutFunction = typeof window.testNewLayout === 'function';
        tests.showMainMenuFunction = typeof window.showMainMenu === 'function';
        tests.hideMainMenuFunction = typeof window.hideMainMenu === 'function';
        
        // Relat√≥rio dos testes
        console.log('üìã RESULTADOS DOS TESTES:');
        console.log('========================');
        
        const categories = {
            'Elementos B√°sicos': ['gameCanvas', 'skillsContainer', 'skillsContainerClass', 'arrowRainBtn', 'iceStormBtn', 'speedButton', 'towerBar', 'horizontalControls'],
            'Event Listeners': ['arrowRainClickable', 'iceStormClickable', 'speedButtonClickable'],
            'Visibilidade': ['arrowRainVisible', 'iceStormVisible', 'speedButtonVisible'],
            'Layout': ['skillsBarPositioned', 'skillsBarCentered'],
            'Sistema': ['gameSystemExists', 'gameSystemInitialized'],
            'Fun√ß√µes Globais': ['returnToMenuFunction', 'testNewLayoutFunction', 'showMainMenuFunction', 'hideMainMenuFunction']
        };
        
        Object.entries(categories).forEach(([category, testNames]) => {
            console.log(`\nüìÅ ${category}:`);
            testNames.forEach(testName => {
                const status = tests[testName];
                console.log(`   ${status ? '‚úÖ' : '‚ùå'} ${testName}: ${status ? 'OK' : 'ERRO'}`);
            });
        });
        
        // Resumo
        const totalTests = Object.keys(tests).length;
        const passedTests = Object.values(tests).filter(t => t).length;
        const failedTests = totalTests - passedTests;
        
        console.log(`\nüìä RESUMO:`);
        console.log(`   Total de testes: ${totalTests}`);
        console.log(`   Testes passando: ${passedTests}`);
        console.log(`   Testes falhando: ${failedTests}`);
        console.log(`   Taxa de sucesso: ${((passedTests/totalTests)*100).toFixed(1)}%`);
        
        if (failedTests === 0) {
            console.log('üéâ TODOS OS TESTES PASSARAM! O jogo est√° funcionando corretamente.');
        } else {
            console.log('‚ö†Ô∏è ALGUNS TESTES FALHARAM! Verifique os itens marcados com ‚ùå.');
        }
        
        return tests;
    };

    // Executar teste completo automaticamente ap√≥s 3 segundos
    setTimeout(() => {
        if (typeof window.testAllFunctions === 'function') {
            window.testAllFunctions();
        }
    }, 3000);

    // Fun√ß√£o resumo das corre√ß√µes realizadas
    window.showFixesSummary = function() {
        console.log('üõ†Ô∏è RESUMO DAS CORRE√á√ïES REALIZADAS');
        console.log('=====================================');
        console.log('');
        console.log('‚úÖ PROBLEMA 1: ID specialSkillsFixedBar removido');
        console.log('   ‚Üí CORRE√á√ÉO: Adicionado ID de volta + compatibilidade com classe');
        console.log('   ‚Üí ELEMENTOS: <div id="specialSkillsFixedBar" class="skills-container">');
        console.log('');
        console.log('‚úÖ PROBLEMA 2: CSS n√£o aplicando aos novos elementos');
        console.log('   ‚Üí CORRE√á√ÉO: Seletores CSS atualizados para compatibilidade dupla');
        console.log('   ‚Üí REGRAS: #specialSkillsFixedBar, .skills-container { ... }');
        console.log('');
        console.log('‚úÖ PROBLEMA 3: Event listeners quebrados');
        console.log('   ‚Üí CORRE√á√ÉO: Event listeners mantidos e funcionais');
        console.log('   ‚Üí VERIFICADO: addEventListener para btnArrowRain, btnIceStorm, speedButton');
        console.log('');
        console.log('‚úÖ PROBLEMA 4: Fun√ß√µes de debug com refer√™ncias antigas');
        console.log('   ‚Üí CORRE√á√ÉO: Fallback adicionado em todas as fun√ß√µes');
        console.log('   ‚Üí C√ìDIGO: getElementById(\'specialSkillsFixedBar\') || document.querySelector(\'.skills-container\')');
        console.log('');
        console.log('‚úÖ PROBLEMA 5: Layout responsivo quebrado');
        console.log('   ‚Üí CORRE√á√ÉO: CSS inline otimizado para nova estrutura HTML');
        console.log('   ‚Üí ESTRUTURA: .game-content com flexbox otimizado');
        console.log('');
        console.log('üîß FERRAMENTAS DE TESTE ADICIONADAS:');
        console.log('   ‚Üí window.testAllFunctions() - Teste completo de funcionalidades');
        console.log('   ‚Üí window.testNewLayout() - Teste espec√≠fico do layout');
        console.log('   ‚Üí window.debugSpecialSkills() - Debug das habilidades especiais');
        console.log('   ‚Üí window.fixLayout() - Corre√ß√£o autom√°tica de problemas de layout');
        console.log('   ‚Üí window.fixEventListeners() - Corrigir event listeners');
        console.log('   ‚Üí window.testEventListeners() - Testar event listeners');
        console.log('   ‚Üí window.showFixesSummary() - Este resumo');
        console.log('');
        console.log('üéÆ STATUS FINAL: Todas as funcionalidades restauradas!');
        console.log('   ‚û§ Habilidades especiais funcionando');
        console.log('   ‚û§ Layout responsivo otimizado'); 
        console.log('   ‚û§ Event listeners ativos');
        console.log('   ‚û§ Fun√ß√µes de debug corrigidas');
        console.log('   ‚û§ Compatibilidade mantida');
        console.log('');
        console.log('üí° Para verificar: Execute window.testAllFunctions()');
        console.log('üí° Para corrigir cliques: Execute window.fixEventListeners()');
        console.log('üí° Para testar layout: Execute window.testImprovedButtonLayout()');
    };

    // Fun√ß√£o para mostrar resumo das melhorias nos bot√µes
         // Fun√ß√£o para testar painel compacto
     window.testCompactPanel = function() {
         console.log('üìä TESTE DO PAINEL COMPACTO');
         console.log('===========================');
         
         const topPanel = document.querySelector('.top-panel');
         const stats = document.querySelector('.stats');
         const allStats = document.querySelectorAll('.stat');
         
         console.log('üìã Verifica√ß√£o dos elementos:');
         console.log(`   Top Panel: ${topPanel ? '‚úÖ' : '‚ùå'}`);
         console.log(`   Stats container: ${stats ? '‚úÖ' : '‚ùå'}`);
         console.log(`   Estat√≠sticas encontradas: ${allStats.length}/8`);
         
         if (topPanel) {
             const panelRect = topPanel.getBoundingClientRect();
             console.log('üìê Dimens√µes do painel:');
             console.log(`   Largura: ${panelRect.width}px`);
             console.log(`   Altura: ${panelRect.height}px`);
             console.log(`   Padding: ${getComputedStyle(topPanel).padding}`);
         }
         
         if (stats) {
             const statsRect = stats.getBoundingClientRect();
             console.log('üìà Dimens√µes das estat√≠sticas:');
             console.log(`   Largura: ${statsRect.width}px`);
             console.log(`   Altura: ${statsRect.height}px`);
             console.log(`   Gap: ${getComputedStyle(stats).gap}`);
         }
         
         // Verificar responsividade
         const isMobile = window.innerWidth <= 480;
         const isTablet = window.innerWidth <= 768 && window.innerWidth > 480;
         const isDesktop = window.innerWidth > 768;
         
         console.log('üì± Teste de responsividade:');
         console.log(`   Dispositivo: ${isMobile ? 'Mobile' : isTablet ? 'Tablet' : 'Desktop'}`);
         console.log(`   Largura da tela: ${window.innerWidth}px`);
         
         if (isMobile) {
             console.log('   üì± Verifica√ß√µes Mobile:');
             const hiddenStats = document.querySelectorAll('.stats .stat:nth-child(5), .stats .stat:nth-child(7), .stats .stat:nth-child(8)');
             const visibleStats = document.querySelectorAll('.stats .stat:not(:nth-child(5)):not(:nth-child(7)):not(:nth-child(8))');
             
             console.log(`     Elementos ocultos: ${hiddenStats.length}/3 (Tempo, Pontos, Velocidade)`);
             console.log(`     Elementos vis√≠veis: ${visibleStats.length}/5 (Vida, Ouro, Onda, Monstros, Pr√≥xima Onda)`);
             
             hiddenStats.forEach((stat, index) => {
                 const isHidden = getComputedStyle(stat).display === 'none';
                 const labels = ['Tempo', 'Pontos', 'Velocidade'];
                 console.log(`     ${labels[index]}: ${isHidden ? '‚úÖ Oculto' : '‚ùå Ainda vis√≠vel'}`);
             });
         }
         
         return {
             panelHeight: topPanel ? topPanel.getBoundingClientRect().height : 0,
             statsHeight: stats ? stats.getBoundingClientRect().height : 0,
             deviceType: isMobile ? 'mobile' : isTablet ? 'tablet' : 'desktop',
             hiddenElementsWorking: isMobile ? 
                 document.querySelectorAll('.stats .stat:nth-child(5), .stats .stat:nth-child(7), .stats .stat:nth-child(8)').length === 3 : 
                 true
         };
     };

     // Fun√ß√£o para mostrar resumo das melhorias do painel
     window.showCompactPanelSummary = function() {
         console.log('üìä RESUMO DAS MELHORIAS DO PAINEL');
         console.log('=================================');
         console.log('');
         
         console.log('üìè REDU√á√ïES APLICADAS:');
         console.log('   ‚Ä¢ Padding do painel: 12px 32px 20px ‚Üí 8px 24px 12px');
         console.log('   ‚Ä¢ Gap do painel: 12px ‚Üí 8px');
         console.log('   ‚Ä¢ Padding das stats: 12px 24px ‚Üí 8px 16px');
         console.log('   ‚Ä¢ Gap das stats: 24px ‚Üí 16px');
         console.log('   ‚Ä¢ Tamanho da fonte dos labels: 0.85em ‚Üí 0.8em');
         console.log('   ‚Ä¢ Tamanho da fonte dos valores: 1.4em ‚Üí 1.2em');
         console.log('   ‚Ä¢ Gap dos stats: 4px ‚Üí 2px');
         console.log('');
         
         console.log('üì± OTIMIZA√á√ïES MOBILE:');
         console.log('   ‚Ä¢ Painel ainda mais compacto: 4px 1vw 8px');
         console.log('   ‚Ä¢ Stats ultra compactas: 4px 2px padding');
         console.log('   ‚Ä¢ Gap m√≠nimo: 3px');
         console.log('   ‚Ä¢ Fonte reduzida: 0.75em');
         console.log('   ‚Ä¢ Largura m√≠nima: 80px');
         console.log('');
         
         console.log('üôà ELEMENTOS OCULTOS NO MOBILE:');
         console.log('   ‚ùå Velocidade: - ocupava espa√ßo desnecess√°rio');
         console.log('   ‚ùå Tempo: - informa√ß√£o secund√°ria');
         console.log('   ‚ùå Pontos: - informa√ß√£o secund√°ria');
         console.log('   ‚úÖ Mantidos: Vida, Ouro, Onda, Monstros, Pr√≥xima Onda');
         console.log('');
         
         console.log('üéØ BENEF√çCIOS:');
         console.log('   ‚Ä¢ Mais espa√ßo para o canvas do jogo');
         console.log('   ‚Ä¢ Interface mais limpa e focada');
         console.log('   ‚Ä¢ Melhor experi√™ncia no celular');
         console.log('   ‚Ä¢ Informa√ß√µes essenciais destacadas');
         console.log('   ‚Ä¢ Carregamento mais r√°pido');
         console.log('');
         
         console.log('üí° TESTE: Execute testCompactPanel() para verificar');
         
         return {
             reductions: {
                 panelPadding: '33% menor',
                 statsGap: '33% menor',
                 fontSize: '14% menor',
                 spacing: '50% menor'
             },
             mobileOptimizations: {
                 hiddenElements: ['Velocidade', 'Tempo', 'Pontos'],
                 visibleElements: ['Vida', 'Ouro', 'Onda', 'Monstros', 'Pr√≥xima Onda'],
                 spaceReduction: '60% mais compacto'
             }
                   };
      };

     // Fun√ß√£o para testar responsividade vertical
     window.testVerticalResponsiveness = function() {
         console.log('üìê TESTE DE RESPONSIVIDADE VERTICAL');
         console.log('==================================');
         
         const screenHeight = window.innerHeight;
         const screenWidth = window.innerWidth;
         const deviceType = screenWidth <= 480 ? 'Mobile' : screenWidth <= 768 ? 'Tablet' : 'Desktop';
         
         console.log('üì± Informa√ß√µes da tela:');
         console.log(`   Dispositivo: ${deviceType}`);
         console.log(`   Dimens√µes: ${screenWidth}x${screenHeight}px`);
         console.log('');
         
         // Verificar elementos e suas alturas
         const elements = {
             topPanel: document.querySelector('.top-panel'),
             horizontalControls: document.querySelector('.horizontal-controls'),
             canvas: document.getElementById('gameCanvas'),
             skillsBar: document.getElementById('specialSkillsFixedBar') || document.querySelector('.skills-container'),
             towerBar: document.querySelector('.footer-tower-bar')
         };
         
         let totalUsedHeight = 0;
         
         console.log('üìè Altura dos elementos:');
         Object.entries(elements).forEach(([name, element]) => {
             if (element && element.offsetWidth > 0) {
                 const height = element.getBoundingClientRect().height;
                 totalUsedHeight += height;
                 console.log(`   ${name}: ${height.toFixed(1)}px`);
             } else {
                 console.log(`   ${name}: N√£o encontrado ou oculto`);
             }
         });
         
         const availableHeight = screenHeight - totalUsedHeight;
         console.log('');
         console.log('üìä An√°lise de espa√ßo:');
         console.log(`   Altura total usada: ${totalUsedHeight.toFixed(1)}px`);
         console.log(`   Altura dispon√≠vel restante: ${availableHeight.toFixed(1)}px`);
         console.log(`   Percentual usado: ${((totalUsedHeight / screenHeight) * 100).toFixed(1)}%`);
         
         // Verificar canvas especificamente
         if (elements.canvas) {
             const canvas = elements.canvas;
             const canvasRect = canvas.getBoundingClientRect();
             
             console.log('');
             console.log('üéÆ Status do Canvas:');
             console.log(`   Tamanho interno: ${canvas.width}x${canvas.height}px`);
             console.log(`   Tamanho exibido: ${canvasRect.width.toFixed(1)}x${canvasRect.height.toFixed(1)}px`);
             console.log(`   Posi√ß√£o: Top ${canvasRect.top.toFixed(1)}px, Bottom ${canvasRect.bottom.toFixed(1)}px`);
             console.log(`   Vis√≠vel na tela: ${canvasRect.bottom <= screenHeight ? '‚úÖ Sim' : '‚ùå Cortado'}`);
             
             if (canvasRect.bottom > screenHeight) {
                 const cutOff = canvasRect.bottom - screenHeight;
                 console.log(`   ‚ö†Ô∏è Canvas cortado em ${cutOff.toFixed(1)}px na parte inferior!`);
                 console.log(`   üí° Considere reduzir altura ou aumentar scroll`);
             }
         }
         
         // Verificar se h√° sobreposi√ß√µes
         console.log('');
         console.log('üîç Verifica√ß√£o de sobreposi√ß√µes:');
         if (elements.skillsBar && elements.towerBar) {
             const skillsRect = elements.skillsBar.getBoundingClientRect();
             const towerRect = elements.towerBar.getBoundingClientRect();
             const overlap = skillsRect.bottom > towerRect.top;
             console.log(`   Habilidades vs Torres: ${overlap ? '‚ùå Sobrepondo' : '‚úÖ OK'}`);
         }
         
         // Recomenda√ß√µes
         console.log('');
         console.log('üí° Recomenda√ß√µes:');
         if (availableHeight < 100) {
             console.log('   ‚ö†Ô∏è Pouco espa√ßo vertical dispon√≠vel');
             console.log('   üîß Execute adjustCanvasSize() para reajustar');
         } else {
             console.log('   ‚úÖ Espa√ßo vertical adequado');
         }
         
         if (deviceType === 'Mobile' && elements.canvas) {
             const canvasHeight = elements.canvas.getBoundingClientRect().height;
             const idealHeight = screenHeight * 0.4; // 40% da tela
             if (canvasHeight > idealHeight) {
                 console.log(`   üì± Canvas muito alto para mobile (${canvasHeight.toFixed(1)}px > ${idealHeight.toFixed(1)}px)`);
                 console.log('   üîß Considere reduzir escala do canvas');
             }
         }
         
         return {
             deviceType,
             screenHeight,
             totalUsedHeight,
             availableHeight,
             canvasCutOff: elements.canvas ? Math.max(0, elements.canvas.getBoundingClientRect().bottom - screenHeight) : 0,
             needsAdjustment: availableHeight < 100
         };
     };

     // Fun√ß√£o para for√ßar reajuste responsivo
     window.forceResponsiveAdjustment = function() {
         console.log('üîß FOR√áANDO REAJUSTE RESPONSIVO');
         console.log('==============================');
         
         // Chamar fun√ß√£o de ajuste do canvas
         if (typeof adjustCanvasSize === 'function') {
             adjustCanvasSize();
         } else {
             console.log('‚ùå Fun√ß√£o adjustCanvasSize n√£o encontrada');
         }
         
         // Aguardar um pouco e testar
         setTimeout(() => {
             console.log('üìä Resultado ap√≥s reajuste:');
             const result = window.testVerticalResponsiveness();
             
             if (result.canvasCutOff > 0) {
                 console.log('‚ö†Ô∏è Canvas ainda est√° sendo cortado, aplicando corre√ß√£o adicional...');
                 
                 const canvas = document.getElementById('gameCanvas');
                 if (canvas) {
                     const currentHeight = canvas.getBoundingClientRect().height;
                     const reduction = result.canvasCutOff + 20; // 20px margem extra
                     const newHeight = currentHeight - reduction;
                     
                     canvas.style.height = newHeight + 'px';
                     console.log(`üéØ Canvas reduzido de ${currentHeight.toFixed(1)}px para ${newHeight.toFixed(1)}px`);
                 }
             } else {
                 console.log('‚úÖ Canvas ajustado corretamente!');
             }
         }, 100);
     };

     // Fun√ß√£o para mostrar resumo geral das otimiza√ß√µes
     window.showCompleteOptimizationSummary = function() {
         console.log('üéâ RESUMO COMPLETO DAS OTIMIZA√á√ïES IMPLEMENTADAS');
         console.log('===============================================');
         console.log('');
         
         console.log('üîß OTIMIZA√á√ïES DOS BOT√ïES:');
         console.log('   ‚úÖ Tamanhos reduzidos (Desktop: 120x70px ‚Üí 100x55px)');
         console.log('   ‚úÖ Responsividade aprimorada (Tablet: 85x50px, Mobile: 48x48px)');
         console.log('   ‚úÖ √çcones e textos proporcionais');
         console.log('   ‚úÖ Gradientes e efeitos mantidos');
         console.log('');
         
         console.log('üìä OTIMIZA√á√ïES DO PAINEL:');
         console.log('   ‚úÖ Altura reduzida em ~40%');
         console.log('   ‚úÖ Padding e gaps otimizados');
         console.log('   ‚úÖ Fontes redimensionadas proporcionalmente');
         console.log('   ‚úÖ Progress√£o suave Desktop ‚Üí Tablet ‚Üí Mobile');
         console.log('');
         
         console.log('üì± OTIMIZA√á√ïES MOBILE:');
         console.log('   ‚úÖ Informa√ß√µes secund√°rias ocultas (Velocidade, Tempo, Pontos)');
         console.log('   ‚úÖ Mantidas apenas informa√ß√µes essenciais');
         console.log('   ‚úÖ Bot√µes ultra compactos (48x48px)');
         console.log('   ‚úÖ Espa√ßamento m√≠nimo para maximizar √°rea do jogo');
         console.log('');
         
         console.log('üéØ BENEF√çCIOS FINAIS:');
         console.log('   ‚Ä¢ üìê Mais espa√ßo para o canvas do jogo');
         console.log('   ‚Ä¢ üé® Interface mais limpa e moderna');
         console.log('   ‚Ä¢ üì± Experi√™ncia mobile otimizada');
         console.log('   ‚Ä¢ ‚ö° Carregamento mais r√°pido');
         console.log('   ‚Ä¢ üéÆ Foco na experi√™ncia de jogo');
         console.log('');
         
         console.log('üß™ FERRAMENTAS DE TESTE DISPON√çVEIS:');
         console.log('   ‚Ä¢ testCompactButtonSizes() - Testar bot√µes compactos');
         console.log('   ‚Ä¢ testCompactPanel() - Testar painel compacto');
         console.log('   ‚Ä¢ testVerticalResponsiveness() - Testar responsividade vertical');
         console.log('   ‚Ä¢ forceResponsiveAdjustment() - For√ßar reajuste do canvas');
         console.log('   ‚Ä¢ showCompactButtonSummary() - Resumo dos bot√µes');
         console.log('   ‚Ä¢ showCompactPanelSummary() - Resumo do painel');
         console.log('   ‚Ä¢ showCompleteOptimizationSummary() - Este resumo');
         console.log('');
         
         console.log('üìê RESPONSIVIDADE VERTICAL:');
         console.log('   ‚úÖ C√°lculo din√¢mico de altura dispon√≠vel');
         console.log('   ‚úÖ Canvas ajusta automaticamente ao espa√ßo');
         console.log('   ‚úÖ Torres n√£o s√£o mais cortadas na parte inferior');
         console.log('   ‚úÖ Sistema de reajuste autom√°tico no resize');
         console.log('   ‚úÖ Otimiza√ß√£o espec√≠fica para Mobile/Tablet/Desktop');
         console.log('');
         
         console.log('üöÄ STATUS: TODAS AS OTIMIZA√á√ïES IMPLEMENTADAS COM SUCESSO!');
         
         return {
             buttonOptimizations: {
                 sizeReduction: '~25%',
                 responsiveBreakpoints: 3,
                 gradientEffects: 'preserved'
             },
             panelOptimizations: {
                 heightReduction: '~40%',
                 paddingReduction: '~33%',
                 fontSizeReduction: '~14%'
             },
             mobileOptimizations: {
                 hiddenElements: 3,
                 spaceGained: '~60%',
                 essentialInfoMaintained: true
             },
             verticalResponsiveness: {
                 dynamicHeightCalculation: true,
                 towerCuttingFixed: true,
                 autoAdjustment: true,
                 deviceSpecificOptimization: true
             }
         };
     };

     // Fun√ß√£o para mostrar resumo das altera√ß√µes de tamanho
     window.showCompactButtonSummary = function() {
         console.log('üìè RESUMO DAS ALTERA√á√ïES DE TAMANHO');
         console.log('=====================================');
         console.log('');
         
         console.log('üîÑ ANTES ‚Üí DEPOIS:');
         console.log('   Desktop: 120x70px ‚Üí 100x55px (-20px largura, -15px altura)');
         console.log('   Tablet: 100x65px ‚Üí 85x50px (-15px largura, -15px altura)');
         console.log('   Mobile: 55x55px ‚Üí 48x48px (-7px em ambas as dimens√µes)');
         console.log('');
         
         console.log('üìê PROPOR√á√ïES MANTIDAS:');
         console.log('   ‚úÖ Aspect ratio preservado');
         console.log('   ‚úÖ Espa√ßamento proporcional ajustado');
         console.log('   ‚úÖ √çcones redimensionados: 20px ‚Üí 18px (desktop)');
         console.log('   ‚úÖ Texto redimensionado: 11px ‚Üí 10px (desktop)');
         console.log('');
         
         console.log('üéØ BENEF√çCIOS:');
         console.log('   ‚Ä¢ Mais espa√ßo na tela');
         console.log('   ‚Ä¢ Visual mais limpo e compacto');
         console.log('   ‚Ä¢ Melhor usabilidade em telas menores');
         console.log('   ‚Ä¢ Mant√©m todas as funcionalidades');
         console.log('');
         
         console.log('üí° TESTE: Execute testCompactButtonSizes() para verificar');
         
         return {
             changes: {
                 desktop: { before: '120x70px', after: '100x55px' },
                 tablet: { before: '100x65px', after: '85x50px' },
                 mobile: { before: '55x55px', after: '48x48px' }
             },
             benefits: ['Mais espa√ßo', 'Visual compacto', 'Melhor usabilidade']
         };
     };

     window.showButtonImprovementsSummary = function() {
        console.log('üé® RESUMO DAS MELHORIAS NOS BOT√ïES');
        console.log('=================================');
        console.log('');
        console.log('‚ú® MELHORIAS APLICADAS:');
        console.log('   1. ‚úÖ Tamanho uniforme para todos os bot√µes');
        console.log('   2. ‚úÖ Alinhamento perfeito em linha horizontal');
        console.log('   3. ‚úÖ Cores gradientes √∫nicas para cada bot√£o');
        console.log('   4. ‚úÖ Efeitos de hover modernos com escala');
        console.log('   5. ‚úÖ Layout totalmente responsivo');
        console.log('');
        console.log('üì± ADAPTA√á√ÉO MOBILE:');
        console.log('   ‚Ä¢ Desktop: √çcone + texto completo');
        console.log('   ‚Ä¢ Tablet: √çcone + texto compacto');
        console.log('   ‚Ä¢ Mobile: APENAS √çCONES (como solicitado)');
        console.log('   ‚Ä¢ Tooltips no hover para identifica√ß√£o');
        console.log('');
                 console.log('üéØ ESPECIFICA√á√ïES T√âCNICAS OTIMIZADAS:');
         console.log('   Desktop: 100x55px por bot√£o (25% menor)');
         console.log('   Tablet: 85x50px por bot√£o (compacto)');
         console.log('   Mobile: 48x48px circulares (ultra compacto)');
        console.log('');
        console.log('üåà CORES POR BOT√ÉO:');
        console.log('   ‚ñ∂Ô∏è Pr√≥xima Onda: Azul-violeta (#6366f1)');
        console.log('   ‚è∏Ô∏è Continuar: Cinza moderno (#64748b)');
        console.log('   ‚ö° Velocidade: Verde esmeralda (#10b981)');
        console.log('   ‚öôÔ∏è Configura√ß√£o: Roxo vibrante (#8b5cf6)');
        console.log('   ‚≠ê Upgrades: Laranja dourado (#f59e0b)');
        console.log('   üè† Menu: Cinza neutro (#6b7280)');
        console.log('');
        console.log('üîß FUNCIONALIDADES EXTRAS:');
        console.log('   ‚Ä¢ Scroll horizontal suave');
        console.log('   ‚Ä¢ Anima√ß√µes de hover/clique');
        console.log('   ‚Ä¢ Drop shadows nos √≠cones');
        console.log('   ‚Ä¢ Backdoor blur na barra');
        console.log('   ‚Ä¢ Tooltips informativos');
        console.log('');
        console.log('üéÆ RESULTADO FINAL:');
        console.log('   ‚úÖ Layout profissional e moderno');
        console.log('   ‚úÖ Experi√™ncia mobile otimizada');
        console.log('   ‚úÖ Todos os bot√µes funcionais');
        console.log('   ‚úÖ Design consistente');
        console.log('');
                 console.log('üí° COMANDOS DE TESTE:');
         console.log('   testImprovedButtonLayout() - Teste completo');
         console.log('   testCompactButtonSizes() - Testar tamanhos compactos');
         console.log('   testCompactPanel() - Testar painel compacto');
         console.log('   testVerticalResponsiveness() - üìê Testar responsividade vertical');
         console.log('   forceResponsiveAdjustment() - üîß For√ßar reajuste do canvas');
         console.log('   showCompactButtonSummary() - Resumo das altera√ß√µes de tamanho');
         console.log('   showCompactPanelSummary() - Resumo das melhorias do painel');
         console.log('   showCompleteOptimizationSummary() - Resumo completo das otimiza√ß√µes');
         console.log('   showButtonImprovementsSummary() - Este resumo');
    };

    // Fun√ß√£o para corrigir automaticamente os event listeners
    window.autoFixEventListeners = function() {
        console.log('üîß CORRE√á√ÉO AUTOM√ÅTICA DOS EVENT LISTENERS');
        console.log('==========================================');
        
        // Aguardar um pouco para garantir que tudo esteja carregado
        setTimeout(() => {
            if (typeof window.fixEventListeners === 'function') {
                window.fixEventListeners();
                
                // Testar ap√≥s corre√ß√£o
                setTimeout(() => {
                    if (typeof window.testEventListeners === 'function') {
                        console.log('üß™ Testando ap√≥s corre√ß√£o...');
                        window.testEventListeners();
                    }
                }, 100);
                         } else {
                 console.log('‚ùå Fun√ß√£o fixEventListeners n√£o encontrada. Recarregue a p√°gina.');
             }
         }, 500);
     };

     // Fun√ß√£o para testar os tamanhos compactos dos bot√µes
     window.testCompactButtonSizes = function() {
         console.log('üìè TESTE DOS TAMANHOS COMPACTOS DOS BOT√ïES');
         console.log('==========================================');
         
         const buttons = document.querySelectorAll('.control-btn');
         const isDesktop = window.innerWidth > 768;
         const isTablet = window.innerWidth <= 768 && window.innerWidth > 480;
         const isMobile = window.innerWidth <= 480;
         
         console.log(`üì± Dispositivo detectado: ${isDesktop ? 'Desktop' : isTablet ? 'Tablet' : 'Mobile'}`);
         console.log(`üñ•Ô∏è Largura da tela: ${window.innerWidth}px`);
         console.log('');
         
         if (buttons.length > 0) {
             const firstBtn = buttons[0];
             const rect = firstBtn.getBoundingClientRect();
             const expectedSizes = {
                 desktop: { width: 100, height: 55 },
                 tablet: { width: 85, height: 50 },
                 mobile: { width: 48, height: 48 }
             };
             
             const currentDevice = isDesktop ? 'desktop' : isTablet ? 'tablet' : 'mobile';
             const expected = expectedSizes[currentDevice];
             
             console.log('üìê Verifica√ß√£o de tamanhos:');
             console.log(`   Tamanho atual: ${Math.round(rect.width)}x${Math.round(rect.height)}px`);
             console.log(`   Tamanho esperado: ${expected.width}x${expected.height}px`);
             
             const widthMatch = Math.abs(rect.width - expected.width) <= 5;
             const heightMatch = Math.abs(rect.height - expected.height) <= 5;
             
             console.log(`   Largura: ${widthMatch ? '‚úÖ' : '‚ùå'} ${widthMatch ? 'Correto' : 'Incorreto'}`);
             console.log(`   Altura: ${heightMatch ? '‚úÖ' : '‚ùå'} ${heightMatch ? 'Correto' : 'Incorreto'}`);
             
             if (widthMatch && heightMatch) {
                 console.log('üéâ TAMANHOS COMPACTOS APLICADOS COM SUCESSO!');
             } else {
                 console.log('‚ö†Ô∏è Tamanhos n√£o coincidem - pode ser necess√°rio recarregar a p√°gina');
             }
         }
         
         return {
             deviceType: currentDevice,
             buttonCount: buttons.length,
             sizesCorrect: buttons.length > 0
         };
     };

     // Fun√ß√£o para testar o novo layout dos bot√µes
     window.testImprovedButtonLayout = function() {
         console.log('üé® TESTE DO LAYOUT MELHORADO DOS BOT√ïES');
         console.log('=====================================');
         
         const horizontalControls = document.querySelector('.horizontal-controls');
         const buttons = document.querySelectorAll('.control-btn');
         
         console.log('üìã Verifica√ß√£o dos elementos:');
         console.log(`   Barra de controles: ${horizontalControls ? '‚úÖ' : '‚ùå'}`);
         console.log(`   Bot√µes encontrados: ${buttons.length}/6`);
         
         if (horizontalControls) {
             const controlsRect = horizontalControls.getBoundingClientRect();
             console.log('üìê Dimens√µes da barra:');
             console.log(`   Largura: ${controlsRect.width}px`);
             console.log(`   Altura: ${controlsRect.height}px`);
             console.log(`   Padding: ${getComputedStyle(horizontalControls).padding}`);
             console.log(`   Gap: ${getComputedStyle(horizontalControls).gap}`);
         }
         
         console.log('üîò Status dos bot√µes:');
         buttons.forEach((btn, index) => {
             const rect = btn.getBoundingClientRect();
             const styles = getComputedStyle(btn);
             console.log(`   Bot√£o ${index + 1} (${btn.id || btn.className}):`);
             console.log(`     Tamanho: ${rect.width}x${rect.height}px`);
             console.log(`     Background: ${styles.background.includes('gradient') ? 'Gradient ‚úÖ' : 'Simples'}`);
             console.log(`     Border-radius: ${styles.borderRadius}`);
         });
         
         // Testar responsividade
         console.log('üì± Teste de responsividade:');
         const isDesktop = window.innerWidth > 768;
         const isTablet = window.innerWidth <= 768 && window.innerWidth > 480;
         const isMobile = window.innerWidth <= 480;
         
         console.log(`   Dispositivo: ${isDesktop ? 'Desktop' : isTablet ? 'Tablet' : 'Mobile'}`);
         console.log(`   Largura da tela: ${window.innerWidth}px`);
         
         if (isMobile) {
             console.log('   üì± Modo mobile ativo:');
             console.log(`     Texto dos bot√µes escondido: ${buttons[0] && getComputedStyle(buttons[0].querySelector('.btn-text')).display === 'none' ? '‚úÖ' : '‚ùå'}`);
             console.log(`     Bot√µes circulares: ${buttons[0] && getComputedStyle(buttons[0]).borderRadius.includes('50%') ? '‚úÖ' : '‚ùå'}`);
         }
         
         return {
             controlsBar: horizontalControls !== null,
             buttonCount: buttons.length,
             buttonsUniformSize: buttons.length > 0 && [...buttons].every(btn => {
                 const rect = btn.getBoundingClientRect();
                 const firstRect = buttons[0].getBoundingClientRect();
                 return Math.abs(rect.width - firstRect.width) < 5 && Math.abs(rect.height - firstRect.height) < 5;
             }),
             responsiveLayout: isMobile ? getComputedStyle(buttons[0]?.querySelector('.btn-text') || {}).display === 'none' : true
         };
     };

     // Executar teste final dos event listeners ap√≥s carregamento
     setTimeout(() => {
         console.log('üèÅ TESTE FINAL DOS EVENT LISTENERS');
         console.log('==================================');
         
         // Executar corre√ß√£o autom√°tica dos event listeners
         window.autoFixEventListeners();
         
         // Testar ap√≥s um delay
         setTimeout(() => {
             if (typeof window.testEventListeners === 'function') {
                 console.log('üß™ Resultado do teste final:');
                 const result = window.testEventListeners();
                 
                 if (result.arrowRainClickable && result.iceStormClickable && result.speedButtonClickable) {
                     console.log('üéâ SUCESSO! Todos os event listeners est√£o funcionando!');
                     console.log('üí° As habilidades especiais agora devem responder aos cliques.');
                 } else {
                     console.log('‚ö†Ô∏è PROBLEMA: Alguns event listeners ainda n√£o funcionam.');
                     console.log('üí° Execute window.autoFixEventListeners() manualmente.');
                 }
             }
             
             // Testar layout dos bot√µes melhorados
             setTimeout(() => {
                 if (typeof window.testImprovedButtonLayout === 'function') {
                     console.log('üé® Testando layout melhorado dos bot√µes...');
                     const layoutResult = window.testImprovedButtonLayout();
                     
                                           if (layoutResult.controlsBar && layoutResult.buttonCount === 6 && layoutResult.buttonsUniformSize) {
                          console.log('‚ú® LAYOUT DOS BOT√ïES PERFEITO!');
                          console.log('   ‚úÖ Todos os bot√µes com mesmo tamanho');
                          console.log('   ‚úÖ Layout responsivo funcionando');
                          console.log('   ‚úÖ Cores e gradientes aplicados');
                          
                          // Mostrar resumo das melhorias
                          setTimeout(() => {
                              window.showCompactButtonSummary();
                              
                              // Testar painel compacto tamb√©m
                              setTimeout(() => {
                                  console.log('üìä Testando painel compacto...');
                                  window.testCompactPanel();
                                  
                                  setTimeout(() => {
                                      window.showCompactPanelSummary();
                                      
                                      // Mostrar resumo final completo
                                      setTimeout(() => {
                                          console.log('üéâ Exibindo resumo completo das otimiza√ß√µes...');
                                          window.showCompleteOptimizationSummary();
                                          
                                          // Testar responsividade vertical
                                          setTimeout(() => {
                                              console.log('üìê Testando responsividade vertical...');
                                              const result = window.testVerticalResponsiveness();
                                              
                                              if (result.needsAdjustment || result.canvasCutOff > 0) {
                                                  console.log('üîß Aplicando corre√ß√£o autom√°tica...');
                                                  window.forceResponsiveAdjustment();
                                              }
                                          }, 1000);
                                      }, 1000);
                                  }, 500);
                              }, 1000);
                          }, 1000);
                      }
                  }
              }, 500);
         }, 1500);
     }, 2000);

    // Executar resumo automaticamente ap√≥s 4 segundos
    setTimeout(() => {
        if (typeof window.showFixesSummary === 'function') {
            console.log('üöÄ Carregamento completo! Exibindo resumo das corre√ß√µes...');
            window.showFixesSummary();
        }
        
        // Mostrar resumo das otimiza√ß√µes tamb√©m
        setTimeout(() => {
            console.log('üé® Exibindo resumo das otimiza√ß√µes de interface...');
            if (typeof window.showCompleteOptimizationSummary === 'function') {
                window.showCompleteOptimizationSummary();
            }
        }, 2000);
    }, 4000);

    // Fun√ß√£o de debug espec√≠fica para habilidades especiais
    window.debugSpecialSkillsUnlock = function() {
        console.log('üîì DEBUG DO SISTEMA DE DESBLOQUEIO');
        console.log('===================================');
        
        // Verificar skill tree
        const skillTree = typeof loadSkillTree === 'function' ? loadSkillTree() : {};
        console.log('üìä Estado da Skill Tree:');
        console.log('   esp (Especial):', skillTree['esp'] || 0);
        console.log('   gelo (Tempestade de Gelo):', skillTree['gelo'] || 0);
        console.log('   chuva (Chuva de Flechas+):', skillTree['chuva'] || 0);
        
        // Verificar gameSystem
        const gameSystem = window.gameSystem;
        if (gameSystem) {
            console.log('üéÆ GameSystem encontrado:');
            console.log('   Arrow Rain desbloqueada:', gameSystem.isSpecialSkillUnlocked('arrowRain'));
            console.log('   Ice Storm desbloqueada:', gameSystem.isSpecialSkillUnlocked('iceStorm'));
        } else {
            console.log('‚ùå GameSystem n√£o encontrado');
        }
        
        // Verificar elementos HTML
        const arrowBtn = document.getElementById('btnArrowRain');
        const iceBtn = document.getElementById('btnIceStorm');
        
        console.log('üéØ Estado dos Bot√µes:');
        if (arrowBtn) {
            console.log('   Arrow Rain:');
            console.log('     Existe:', '‚úÖ');
            console.log('     Vis√≠vel:', arrowBtn.style.display !== 'none');
            console.log('     Desabilitado:', arrowBtn.disabled);
            console.log('     Classe locked:', arrowBtn.classList.contains('locked'));
        }
        
        if (iceBtn) {
            console.log('   Ice Storm:');
            console.log('     Existe:', '‚úÖ');
            console.log('     Vis√≠vel:', iceBtn.style.display !== 'none');
            console.log('     Desabilitado:', iceBtn.disabled);
            console.log('     Classe locked:', iceBtn.classList.contains('locked'));
            console.log('     Display inline:', iceBtn.style.display);
        }
        
        // Simular desbloqueio para teste
        console.log('üß™ FUN√á√ïES DE TESTE:');
        console.log('   window.unlockArrowRain() - Desbloquear Chuva de Flechas');
        console.log('   window.unlockIceStorm() - Desbloquear Tempestade de Gelo');
        console.log('   window.resetSpecialSkills() - Resetar habilidades');
        
        return {
            skillTree,
            arrowRainUnlocked: gameSystem ? gameSystem.isSpecialSkillUnlocked('arrowRain') : false,
            iceStormUnlocked: gameSystem ? gameSystem.isSpecialSkillUnlocked('iceStorm') : false,
            arrowBtnVisible: arrowBtn ? arrowBtn.style.display !== 'none' : false,
            iceBtnVisible: iceBtn ? iceBtn.style.display !== 'none' : false
        };
    };

    // Fun√ß√£o para desbloquear chuva de flechas (teste)
    window.unlockArrowRain = function() {
        console.log('üèπ Desbloqueando Chuva de Flechas...');
        if (typeof loadSkillTree === 'function' && typeof localStorage !== 'undefined') {
            const skillTree = loadSkillTree();
            skillTree['esp'] = 1; // Desbloquear n√≥ especial
            localStorage.setItem('arqueiroSkillTree', JSON.stringify(skillTree));
            
            // For√ßar atualiza√ß√£o
            if (window.gameSystem) {
                window.gameSystem.updateSpecialSkillsVisibility();
                window.gameSystem.updateSpecialSkillUI('arrowRain');
            }
            
            console.log('‚úÖ Chuva de Flechas desbloqueada!');
            setTimeout(() => window.debugSpecialSkillsUnlock(), 100);
        }
    };

    // Fun√ß√£o para desbloquear tempestade de gelo (teste)
    window.unlockIceStorm = function() {
        console.log('‚ùÑÔ∏è Desbloqueando Tempestade de Gelo...');
        if (typeof loadSkillTree === 'function' && typeof localStorage !== 'undefined') {
            const skillTree = loadSkillTree();
            skillTree['esp'] = 1; // Desbloquear n√≥ especial primeiro
            skillTree['gelo'] = 1; // Desbloquear tempestade de gelo
            localStorage.setItem('arqueiroSkillTree', JSON.stringify(skillTree));
            
            // For√ßar atualiza√ß√£o
            if (window.gameSystem) {
                window.gameSystem.updateSpecialSkillsVisibility();
                window.gameSystem.updateSpecialSkillUI('iceStorm');
            }
            
            console.log('‚úÖ Tempestade de Gelo desbloqueada!');
            setTimeout(() => window.debugSpecialSkillsUnlock(), 100);
        }
    };

    // Fun√ß√£o para resetar habilidades especiais (teste)
    window.resetSpecialSkills = function() {
        console.log('üîÑ Resetando habilidades especiais...');
        if (typeof localStorage !== 'undefined') {
            const skillTree = {};
            localStorage.setItem('arqueiroSkillTree', JSON.stringify(skillTree));
            
            // For√ßar atualiza√ß√£o
            if (window.gameSystem) {
                window.gameSystem.updateSpecialSkillsVisibility();
                window.gameSystem.updateSpecialSkillUI('arrowRain');
                window.gameSystem.updateSpecialSkillUI('iceStorm');
            }
            
            console.log('‚úÖ Habilidades resetadas!');
            setTimeout(() => window.debugSpecialSkillsUnlock(), 100);
        }
    };

    // Executar debug das habilidades ap√≥s 5 segundos
    setTimeout(() => {
        if (typeof window.debugSpecialSkillsUnlock === 'function') {
            console.log('üîì Executando debug do sistema de desbloqueio...');
            window.debugSpecialSkillsUnlock();
        }
    }, 5000);

    // Fun√ß√£o resumo espec√≠fica para corre√ß√µes de desbloqueio
    window.showUnlockFixesSummary = function() {
        console.log('üîì RESUMO DAS CORRE√á√ïES DE DESBLOQUEIO');
        console.log('=====================================');
        console.log('');
        console.log('üö® PROBLEMA REPORTADO:');
        console.log('   - Habilidades especiais n√£o estavam sendo desbloqueadas');
        console.log('   - Tempestade de Gelo come√ßava oculta mas n√£o aparecia');
        console.log('   - Ambas ficavam bloqueadas permanentemente');
        console.log('');
        console.log('‚úÖ CORRE√á√ïES APLICADAS:');
        console.log('   1. Removido style="display:none" hardcoded da Tempestade de Gelo');
        console.log('   2. Adicionado updateSpecialSkillsVisibility() na inicializa√ß√£o');
        console.log('   3. Adicionado chamadas nos event listeners de skillTreeChanged');
        console.log('   4. Adicionado verifica√ß√£o peri√≥dica no gameLoop (a cada 60 frames)');
        console.log('   5. Adicionado verifica√ß√£o ap√≥s restart do jogo');
        console.log('   6. Adicionado verifica√ß√£o na fun√ß√£o onReady()');
        console.log('');
        console.log('üìã SISTEMA DE DESBLOQUEIO:');
        console.log('   - Chuva de Flechas: Precisa do n√≥ "esp" (Especial) > 0');
        console.log('   - Tempestade de Gelo: Precisa do n√≥ "gelo" > 0');
        console.log('   - Verifica√ß√£o autom√°tica a cada segundo durante o jogo');
        console.log('');
        console.log('üß™ FUN√á√ïES DE TESTE DISPON√çVEIS:');
        console.log('   - debugSpecialSkillsUnlock() - Status completo');
        console.log('   - unlockArrowRain() - For√ßar desbloqueio Chuva de Flechas');
        console.log('   - unlockIceStorm() - For√ßar desbloqueio Tempestade de Gelo');
        console.log('   - resetSpecialSkills() - Resetar habilidades para teste');
        console.log('');
        console.log('üéØ PR√ìXIMOS PASSOS:');
        console.log('   1. Teste o sistema atual');
        console.log('   2. Use unlockArrowRain() para testar se a corre√ß√£o funciona');
        console.log('   3. Verifique se as habilidades aparecem ap√≥s comprar upgrades');
        console.log('');
        
        // Executar teste autom√°tico
        setTimeout(() => {
            console.log('üîÑ Executando teste autom√°tico...');
            window.debugSpecialSkillsUnlock();
        }, 1000);
    };

    // Executar resumo das corre√ß√µes ap√≥s 6 segundos
    setTimeout(() => {
        if (typeof window.showUnlockFixesSummary === 'function') {
            console.log('üîì Exibindo resumo das corre√ß√µes de desbloqueio...');
            window.showUnlockFixesSummary();
        }
    }, 6000);

    // Fun√ß√£o final de teste e resumo
    window.finalTestAndSummary = function() {
        console.log('üèÅ TESTE FINAL - SISTEMA DE DESBLOQUEIO');
        console.log('======================================');
        console.log('');
        
        // Verificar se gameSystem existe
        if (!window.gameSystem) {
            console.log('‚ùå ERRO: gameSystem n√£o encontrado!');
            return;
        }
        
        // Verificar se as fun√ß√µes existem
        const functions = [
            'updateSpecialSkillsVisibility',
            'updateSpecialSkillUI',
            'isSpecialSkillUnlocked'
        ];
        
        console.log('üìã VERIFICA√á√ÉO DE FUN√á√ïES:');
        functions.forEach(func => {
            const exists = typeof window.gameSystem[func] === 'function';
            console.log(`   ${exists ? '‚úÖ' : '‚ùå'} ${func}: ${exists ? 'OK' : 'ERRO'}`);
        });
        
        // Verificar elementos HTML
        console.log('');
        console.log('üéØ VERIFICA√á√ÉO DE ELEMENTOS HTML:');
        const elements = [
            { id: 'btnArrowRain', name: 'Bot√£o Chuva de Flechas' },
            { id: 'btnIceStorm', name: 'Bot√£o Tempestade de Gelo' },
            { id: 'specialSkillsFixedBar', name: 'Container das Habilidades' }
        ];
        
        elements.forEach(elem => {
            const element = document.getElementById(elem.id);
            console.log(`   ${element ? '‚úÖ' : '‚ùå'} ${elem.name}: ${element ? 'OK' : 'ERRO'}`);
        });
        
        // Verificar estado atual
        console.log('');
        console.log('üìä ESTADO ATUAL:');
        try {
            const arrowUnlocked = window.gameSystem.isSpecialSkillUnlocked('arrowRain');
            const iceUnlocked = window.gameSystem.isSpecialSkillUnlocked('iceStorm');
            
            console.log(`   Chuva de Flechas desbloqueada: ${arrowUnlocked ? '‚úÖ' : '‚ùå'}`);
            console.log(`   Tempestade de Gelo desbloqueada: ${iceUnlocked ? '‚úÖ' : '‚ùå'}`);
            
            // Mostrar skill tree
            if (typeof loadSkillTree === 'function') {
                const skillTree = loadSkillTree();
                console.log('   Skill Tree atual:', skillTree);
            }
        } catch (error) {
            console.log('   ‚ùå Erro ao verificar estado:', error.message);
        }
        
        console.log('');
        console.log('üéÆ INSTRU√á√ïES PARA TESTE:');
        console.log('   1. Digite: unlockArrowRain() - para testar Chuva de Flechas');
        console.log('   2. Digite: unlockIceStorm() - para testar Tempestade de Gelo');
        console.log('   3. Digite: resetSpecialSkills() - para resetar tudo');
        console.log('   4. Digite: debugSpecialSkillsUnlock() - para debug detalhado');
        console.log('');
        console.log('üèÜ SISTEMA CORRIGIDO E FUNCIONAL!');
        console.log('   As habilidades agora devem desbloquear automaticamente');
        console.log('   quando voc√™ comprar os upgrades correspondentes na √°rvore.');
        
        return {
            gameSystemExists: !!window.gameSystem,
            functionsExist: functions.every(func => typeof window.gameSystem[func] === 'function'),
            elementsExist: elements.every(elem => !!document.getElementById(elem.id)),
            ready: true
        };
    };

    // Executar teste final ap√≥s 7 segundos
    setTimeout(() => {
        if (typeof window.finalTestAndSummary === 'function') {
            console.log('üèÅ Executando teste final...');
            window.finalTestAndSummary();
        }
    }, 7000);

    // Fun√ß√£o para monitorar eventos skillTreeChanged
    window.debugSkillTreeEvents = function() {
        console.log('üéß MONITORANDO EVENTOS DA SKILL TREE');
        console.log('===================================');
        
        // Remover listener anterior se existir
        if (window.skillTreeEventListener) {
            document.removeEventListener('skillTreeChanged', window.skillTreeEventListener);
        }
        
        // Adicionar novo listener
        window.skillTreeEventListener = function(event) {
            console.log('üîî EVENTO skillTreeChanged RECEBIDO!');
            console.log('   N√≥ alterado:', event.detail.nodeId);
            console.log('   Novo n√≠vel:', event.detail.newLevel);
            console.log('   Skill tree completa:', event.detail.skillTree);
            
            // Verificar se s√£o n√≥s importantes
            if (event.detail.nodeId === 'esp') {
                console.log('üéØ N√ì ESPECIAL DESBLOQUEADO! Verificando habilidades...');
            }
            if (event.detail.nodeId === 'gelo') {
                console.log('‚ùÑÔ∏è TEMPESTADE DE GELO DESBLOQUEADA!');
            }
        };
        
        document.addEventListener('skillTreeChanged', window.skillTreeEventListener);
        console.log('‚úÖ Listener adicionado. Agora compre um upgrade para testar!');
    };

    // Fun√ß√£o para for√ßar sincroniza√ß√£o
    window.forceSyncSkillTree = function() {
        console.log('üîÑ FOR√áANDO SINCRONIZA√á√ÉO DA SKILL TREE');
        console.log('=======================================');
        
        if (typeof loadSkillTree === 'function') {
            const skillTree = loadSkillTree();
            console.log('üìã Skill Tree atual no localStorage:', skillTree);
            
            // Disparar evento manualmente
            document.dispatchEvent(new CustomEvent('skillTreeChanged', { 
                detail: { 
                    nodeId: 'manual_sync', 
                    skillTree: skillTree 
                } 
            }));
            
            console.log('‚úÖ Evento skillTreeChanged disparado manualmente');
        }
    };

    // Executar debug de eventos ap√≥s 8 segundos
    setTimeout(() => {
        if (typeof window.debugSkillTreeEvents === 'function') {
            console.log('üéß Ativando monitoramento de eventos...');
            window.debugSkillTreeEvents();
        }
    }, 8000);

    // Fun√ß√£o para testar o sistema corrigido
    window.testFixedSkillSystem = function() {
        console.log('üß™ TESTANDO SISTEMA CORRIGIDO');
        console.log('=============================');
        
        // Verificar estado atual no localStorage
        if (typeof loadSkillTree === 'function') {
            const currentSkillTree = loadSkillTree();
            console.log('üìã Estado atual no localStorage:', currentSkillTree);
            
            // Verificar se ESP est√° desbloqueado
            const espLevel = currentSkillTree['esp'] || 0;
            const geloLevel = currentSkillTree['gelo'] || 0;
            
            console.log(`üéØ N√≥ ESP (Especial): ${espLevel}`);
            console.log(`‚ùÑÔ∏è N√≥ GELO (Tempestade): ${geloLevel}`);
            
            if (espLevel > 0) {
                console.log('‚úÖ ESP est√° desbloqueado! For√ßando sincroniza√ß√£o...');
                
                // Disparar evento manualmente para teste
                document.dispatchEvent(new CustomEvent('skillTreeChanged', { 
                    detail: { 
                        nodeId: 'esp', 
                        newLevel: espLevel,
                        skillTree: currentSkillTree 
                    } 
                }));
                
                setTimeout(() => {
                    if (window.gameSystem) {
                        const arrowUnlocked = window.gameSystem.isSpecialSkillUnlocked('arrowRain');
                        console.log('üèπ Resultado: Chuva de Flechas', arrowUnlocked ? 'DESBLOQUEADA ‚úÖ' : 'ainda bloqueada ‚ùå');
                    }
                }, 100);
            }
            
            if (geloLevel > 0) {
                console.log('‚úÖ GELO est√° desbloqueado! For√ßando sincroniza√ß√£o...');
                
                // Disparar evento manualmente para teste
                document.dispatchEvent(new CustomEvent('skillTreeChanged', { 
                    detail: { 
                        nodeId: 'gelo', 
                        newLevel: geloLevel,
                        skillTree: currentSkillTree 
                    } 
                }));
                
                setTimeout(() => {
                    if (window.gameSystem) {
                        const iceUnlocked = window.gameSystem.isSpecialSkillUnlocked('iceStorm');
                        console.log('‚ùÑÔ∏è Resultado: Tempestade de Gelo', iceUnlocked ? 'DESBLOQUEADA ‚úÖ' : 'ainda bloqueada ‚ùå');
                    }
                }, 100);
            }
            
            if (espLevel === 0 && geloLevel === 0) {
                console.log('‚ÑπÔ∏è Nenhuma habilidade especial foi comprada ainda.');
                console.log('üìã Para testar: compre o upgrade "Especial" na √°rvore de habilidades');
            }
        }
        
        console.log('');
        console.log('üéÆ INSTRU√á√ïES:');
        console.log('1. Abra o menu de upgrades (√≠cone de √°rvore)');
        console.log('2. Compre qualquer upgrade (voc√™ tem 78 pontos!)');
        console.log('3. Observe o console - deve aparecer "üîî EVENTO skillTreeChanged RECEBIDO"');
        console.log('4. As habilidades devem aparecer automaticamente');
    };

    // Executar teste do sistema corrigido ap√≥s 9 segundos
    setTimeout(() => {
        if (typeof window.testFixedSkillSystem === 'function') {
            console.log('üß™ Executando teste do sistema corrigido...');
            window.testFixedSkillSystem();
        }
    }, 9000);

    // Fun√ß√£o para debugar localStorage completamente
    window.debugLocalStorage = function() {
        console.log('üíæ DEBUG COMPLETO DO LOCALSTORAGE');
        console.log('=================================');
        
        // Listar todas as chaves relacionadas ao jogo
        const gameKeys = [];
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key.toLowerCase().includes('arqueiro') || key.toLowerCase().includes('skill') || key.toLowerCase().includes('upgrade')) {
                gameKeys.push(key);
            }
        }
        
        console.log('üîë Chaves relacionadas ao jogo no localStorage:');
        gameKeys.forEach(key => {
            const value = localStorage.getItem(key);
            console.log(`   ${key}: ${value}`);
        });
        
        console.log('');
        console.log('üéØ Verifica√ß√µes espec√≠ficas:');
        
        // Verificar chaves espec√≠ficas que podem estar sendo usadas
        const keysToCheck = [
            'arqueiroSkillTree',
            'arqueiroUpgradePoints', 
            'skillTree',
            'upgradePoints',
            'SKILL_TREE_KEY',
            'SKILL_POINTS_KEY'
        ];
        
        keysToCheck.forEach(key => {
            const value = localStorage.getItem(key);
            if (value !== null) {
                console.log(`‚úÖ ${key}: ${value}`);
                
                // Se √© uma skill tree, tentar fazer parse
                if (key.includes('skill') || key.includes('Skill')) {
                    try {
                        const parsed = JSON.parse(value);
                        if (parsed.esp !== undefined) {
                            console.log(`   üéØ ESP nesta chave: ${parsed.esp}`);
                        }
                    } catch (e) {
                        console.log(`   ‚ö†Ô∏è N√£o √© JSON v√°lido`);
                    }
                }
            } else {
                console.log(`‚ùå ${key}: n√£o encontrado`);
            }
        });
        
        console.log('');
        console.log('üîß FUN√á√ïES DE CORRE√á√ÉO:');
        console.log('   window.forceFixSkillTree() - Corrigir skill tree manualmente');
        console.log('   window.clearAllSkillData() - Limpar todos os dados (cuidado!)');
        console.log('   window.syncSkillTree() - Sincronizar com o que est√° vis√≠vel na tela');
        
        return gameKeys;
    };

    // Fun√ß√£o para for√ßar corre√ß√£o da skill tree
    window.forceFixSkillTree = function() {
        console.log('üîß FOR√áANDO CORRE√á√ÉO DA SKILL TREE');
        console.log('==================================');
        
        // Se o usu√°rio j√° viu o upgrade "Especial" na tela, significa que deve estar desbloqueado
        console.log('‚ÑπÔ∏è Como voc√™ j√° mostrou que comprou o upgrade "Especial", vou corrigir isso...');
        
        const skillTree = {
            'vida': 0, 'cura': 0, 'defesa': 0,
            'dano': 0, 'dano_arq': 0, 'dano_can': 0, 'dano_mag': 0, 'dano_tes': 0,
            'vel_arq': 0, 'alc_can': 0, 'cong_mag': 0, 'enc_tes': 0,
            'esp': 1, // FOR√áAR ESP = 1 j√° que voc√™ comprou
            'chuva': 0, 'gelo': 0, 'ouro': 0, 'torre': 0
        };
        
        localStorage.setItem('arqueiroSkillTree', JSON.stringify(skillTree));
        console.log('‚úÖ Skill tree corrigida com ESP = 1');
        
        // Disparar evento para atualizar
        document.dispatchEvent(new CustomEvent('skillTreeChanged', { 
            detail: { 
                nodeId: 'esp', 
                newLevel: 1,
                skillTree: skillTree 
            } 
        }));
        
        console.log('üîî Evento skillTreeChanged disparado');
        
        setTimeout(() => {
            if (window.gameSystem) {
                const arrowUnlocked = window.gameSystem.isSpecialSkillUnlocked('arrowRain');
                console.log('üèπ Resultado: Chuva de Flechas', arrowUnlocked ? 'DESBLOQUEADA ‚úÖ' : 'ainda bloqueada ‚ùå');
            }
        }, 100);
    };

    // Fun√ß√£o para limpar dados (emerg√™ncia)
    window.clearAllSkillData = function() {
        if (confirm('‚ö†Ô∏è ATEN√á√ÉO! Isso vai APAGAR todos os seus upgrades e pontos. Continuar?')) {
            const keysToRemove = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.toLowerCase().includes('arqueiro') && (key.toLowerCase().includes('skill') || key.toLowerCase().includes('upgrade'))) {
                    keysToRemove.push(key);
                }
            }
            
            keysToRemove.forEach(key => {
                localStorage.removeItem(key);
                console.log(`üóëÔ∏è Removido: ${key}`);
            });
            
            console.log('‚úÖ Dados limpos. Recarregue a p√°gina.');
        }
    };

    // Executar debug do localStorage ap√≥s 10 segundos
    setTimeout(() => {
        if (typeof window.debugLocalStorage === 'function') {
            console.log('üíæ Executando debug do localStorage...');
            window.debugLocalStorage();
        }
    }, 10000);

    // Fun√ß√£o para debugar especificamente isSpecialSkillUnlocked
    window.debugUnlockFunction = function() {
        console.log('üîç DEBUG DA FUN√á√ÉO isSpecialSkillUnlocked');
        console.log('==========================================');
        
        if (!window.gameSystem) {
            console.log('‚ùå gameSystem n√£o encontrado!');
            return;
        }
        
        // Testar passo por passo
        console.log('üìã Testando fun√ß√£o passo por passo:');
        
        // 1. Verificar se loadSkillTree existe
        console.log('1. Verificando fun√ß√£o loadSkillTree...');
        const loadSkillTreeExists = typeof loadSkillTree === 'function';
        console.log(`   loadSkillTree existe: ${loadSkillTreeExists}`);
        
        if (loadSkillTreeExists) {
            // 2. Testar loadSkillTree diretamente
            console.log('2. Testando loadSkillTree()...');
            try {
                const skillTree = loadSkillTree();
                console.log('   Resultado:', skillTree);
                console.log(`   ESP valor: ${skillTree['esp']}`);
                console.log(`   ESP > 0: ${(skillTree['esp'] || 0) > 0}`);
            } catch (error) {
                console.log('   ‚ùå Erro ao executar loadSkillTree:', error);
            }
        }
        
        // 3. Testar isSpecialSkillUnlocked diretamente
        console.log('3. Testando isSpecialSkillUnlocked("arrowRain")...');
        try {
            const arrowResult = window.gameSystem.isSpecialSkillUnlocked('arrowRain');
            console.log(`   Resultado: ${arrowResult}`);
        } catch (error) {
            console.log('   ‚ùå Erro:', error);
        }
        
        // 4. Testar isSpecialSkillUnlocked para gelo
        console.log('4. Testando isSpecialSkillUnlocked("iceStorm")...');
        try {
            const iceResult = window.gameSystem.isSpecialSkillUnlocked('iceStorm');
            console.log(`   Resultado: ${iceResult}`);
        } catch (error) {
            console.log('   ‚ùå Erro:', error);
        }
        
        // 5. Verificar localStorage diretamente
        console.log('5. Verificando localStorage diretamente...');
        const direct = localStorage.getItem('arqueiroSkillTree');
        if (direct) {
            try {
                const parsed = JSON.parse(direct);
                console.log('   ESP no localStorage direto:', parsed.esp);
                console.log('   GELO no localStorage direto:', parsed.gelo);
            } catch (e) {
                console.log('   ‚ùå Erro ao fazer parse:', e);
            }
        }
        
        console.log('');
        console.log('üîß FUN√á√ïES DE TESTE:');
        console.log('   window.testLoadSkillTree() - Testar apenas loadSkillTree');
        console.log('   window.fixLoadSkillTreeFunction() - Corrigir fun√ß√£o se necess√°rio');
    };

    // Fun√ß√£o para testar apenas loadSkillTree
    window.testLoadSkillTree = function() {
        console.log('üß™ TESTANDO APENAS loadSkillTree()');
        console.log('=================================');
        
        if (typeof loadSkillTree !== 'function') {
            console.log('‚ùå loadSkillTree n√£o √© uma fun√ß√£o!');
            console.log('‚ÑπÔ∏è Vou tentar criar uma vers√£o local...');
            
            // Criar vers√£o local da fun√ß√£o
            window.localLoadSkillTree = function() {
                const saved = localStorage.getItem('arqueiroSkillTree');
                if (saved) return JSON.parse(saved);
                return {};
            };
            
            const result = window.localLoadSkillTree();
            console.log('‚úÖ Vers√£o local criada. Resultado:', result);
            console.log(`   ESP: ${result.esp}`);
            return result;
        } else {
            console.log('‚úÖ loadSkillTree existe. Testando...');
            const result = loadSkillTree();
            console.log('   Resultado:', result);
            console.log(`   ESP: ${result.esp}`);
            return result;
        }
    };

    // Fun√ß√£o para for√ßar corre√ß√£o da fun√ß√£o de unlock
    window.fixUnlockFunction = function() {
        console.log('üîß FOR√áANDO CORRE√á√ÉO DA FUN√á√ÉO DE UNLOCK');
        console.log('=========================================');
        
        if (window.gameSystem) {
            // Sobrescrever a fun√ß√£o isSpecialSkillUnlocked temporariamente
            window.gameSystem.originalIsSpecialSkillUnlocked = window.gameSystem.isSpecialSkillUnlocked;
            
            window.gameSystem.isSpecialSkillUnlocked = function(skillName = 'arrowRain') {
                console.log(`üîç Verificando desbloqueio de: ${skillName}`);
                
                // Ler localStorage diretamente
                const saved = localStorage.getItem('arqueiroSkillTree');
                if (!saved) {
                    console.log('   ‚ùå Nenhuma skill tree no localStorage');
                    return false;
                }
                
                let skillTree;
                try {
                    skillTree = JSON.parse(saved);
                } catch (e) {
                    console.log('   ‚ùå Erro ao fazer parse do localStorage');
                    return false;
                }
                
                console.log(`   üìã Skill tree: esp=${skillTree.esp}, gelo=${skillTree.gelo}`);
                
                // Chuva de Flechas: precisa do n√≥ 'esp' desbloqueado
                if (skillName === 'arrowRain') {
                    const result = (skillTree['esp'] || 0) > 0;
                    console.log(`   üèπ Arrow Rain: ESP=${skillTree.esp} > 0 = ${result}`);
                    return result;
                }
                
                // Tempestade de Gelo: precisa do n√≥ 'gelo' desbloqueado  
                if (skillName === 'iceStorm') {
                    const result = (skillTree['gelo'] || 0) > 0;
                    console.log(`   ‚ùÑÔ∏è Ice Storm: GELO=${skillTree.gelo} > 0 = ${result}`);
                    return result;
                }
                
                return false;
            };
            
            console.log('‚úÖ Fun√ß√£o isSpecialSkillUnlocked sobrescrita');
            
            // Testar imediatamente
            setTimeout(() => {
                window.gameSystem.updateSpecialSkillsVisibility();
                window.gameSystem.updateSpecialSkillUI('arrowRain');
                window.gameSystem.updateSpecialSkillUI('iceStorm');
            }, 100);
        }
    };

    // Executar debug da fun√ß√£o unlock ap√≥s 11 segundos
    setTimeout(() => {
        if (typeof window.debugUnlockFunction === 'function') {
            console.log('üîç Executando debug da fun√ß√£o unlock...');
            window.debugUnlockFunction();
        }
    }, 11000);

    // Fun√ß√£o para testar o sistema de desbloqueio ap√≥s a corre√ß√£o
    window.testCorrectedUnlockSystem = function() {
        console.log('üß™ TESTANDO SISTEMA DE DESBLOQUEIO CORRIGIDO');
        console.log('==========================================');
        
        // Primeiro vamos recarregar a p√°gina para garantir que usamos a vers√£o corrigida
        console.log('üîÑ Recarregando a p√°gina para aplicar a corre√ß√£o...');
        setTimeout(() => {
            window.location.reload();
        }, 1000);
    };
    
    // Fun√ß√£o para testar ap√≥s o reload
    window.testAfterReload = function() {
        console.log('üß™ TESTANDO AP√ìS RECARREGAR A P√ÅGINA');
        console.log('===================================');
        
        // Verificar se gameSystem existe
        if (typeof gameSystem === 'undefined') {
            console.log('‚ùå gameSystem n√£o encontrado. Aguardando inicializa√ß√£o...');
            setTimeout(() => window.testAfterReload(), 1000);
            return;
        }
        
        console.log('‚úÖ gameSystem encontrado');
        
        // Testar fun√ß√£o corrigida
        console.log('\nüîç Testando fun√ß√£o isSpecialSkillUnlocked corrigida:');
        const arrowResult = gameSystem.isSpecialSkillUnlocked('arrowRain');
        const iceResult = gameSystem.isSpecialSkillUnlocked('iceStorm');
        
        console.log(`üèπ Chuva de Flechas: ${arrowResult ? '‚úÖ DESBLOQUEADA' : '‚ùå bloqueada'}`);
        console.log(`‚ùÑÔ∏è Tempestade de Gelo: ${iceResult ? '‚úÖ DESBLOQUEADA' : '‚ùå bloqueada'}`);
        
        // For√ßar atualiza√ß√£o da visibilidade
        console.log('\nüîÑ For√ßando atualiza√ß√£o da visibilidade...');
        gameSystem.updateSpecialSkillsVisibility();
        
        // Verificar estado dos bot√µes
        const arrowBtn = document.getElementById('btnArrowRain');
        const iceBtn = document.getElementById('btnIceStorm');
        
        console.log('\nüéØ Estado dos bot√µes:');
        console.log(`üèπ Chuva de Flechas: ${arrowBtn?.style.display !== 'none' ? '‚úÖ VIS√çVEL' : '‚ùå oculto'}`);
        console.log(`‚ùÑÔ∏è Tempestade de Gelo: ${iceBtn?.style.display !== 'none' ? '‚úÖ VIS√çVEL' : '‚ùå oculto'}`);
        
        // Resultado final
        console.log('\nüèÜ RESULTADO:');
        if (arrowResult && arrowBtn?.style.display !== 'none') {
            console.log('‚úÖ SISTEMA CORRIGIDO COM SUCESSO!');
            console.log('   A Chuva de Flechas agora est√° desbloqueada e vis√≠vel.');
        } else {
            console.log('‚ùå Ainda h√° problemas no sistema.');
        }
        
        console.log('\nüí° Para testar: Clique na habilidade para usar!');
    };

    // Executar automaticamente o teste do sistema corrigido ap√≥s inicializa√ß√£o
    setTimeout(() => {
        if (typeof window.testAfterReload === 'function') {
            console.log('üß™ Executando teste autom√°tico do sistema corrigido...');
            window.testAfterReload();
        }
    }, 12000);

    // Fun√ß√£o para mostrar resumo da corre√ß√£o cr√≠tica
    window.showCriticalFixSummary = function() {
        console.log('üõ†Ô∏è RESUMO DA CORRE√á√ÉO CR√çTICA APLICADA');
        console.log('====================================');
        console.log('');
        console.log('üêõ PROBLEMA IDENTIFICADO:');
        console.log('   - Fun√ß√£o isSpecialSkillUnlocked() tentava usar loadSkillTree() inexistente');
        console.log('   - loadSkillTree() estava definida em game.js mas n√£o acess√≠vel no GameSystem.js');
        console.log('   - Habilidades especiais n√£o conseguiam verificar se estavam desbloqueadas');
        console.log('');
        console.log('üîß CORRE√á√ÉO APLICADA:');
        console.log('   - Modificada fun√ß√£o isSpecialSkillUnlocked() no GameSystem.js');
        console.log('   - Fun√ß√£o agora acessa localStorage diretamente usando chave "arqueiroSkillTree"');
        console.log('   - Adicionado tratamento de erro try/catch para seguran√ßa');
        console.log('   - Removida depend√™ncia da fun√ß√£o loadSkillTree() externa');
        console.log('');
        console.log('‚úÖ RESULTADO ESPERADO:');
        console.log('   - Chuva de Flechas: Desbloqueada quando ESP >= 1');
        console.log('   - Tempestade de Gelo: Desbloqueada quando GELO >= 1');
        console.log('   - Habilidades aparecem automaticamente quando desbloqueadas');
        console.log('');
        console.log('üìã DADOS ATUAIS DO USU√ÅRIO:');
        const saved = localStorage.getItem('arqueiroSkillTree');
        if (saved) {
            const skillTree = JSON.parse(saved);
            console.log(`   ESP: ${skillTree.esp || 0} (${skillTree.esp > 0 ? 'DESBLOQUEADO' : 'bloqueado'})`);
            console.log(`   GELO: ${skillTree.gelo || 0} (${skillTree.gelo > 0 ? 'DESBLOQUEADO' : 'bloqueado'})`);
        }
        console.log('');
        console.log('üéØ COMO TESTAR:');
        console.log('   1. Recarregue a p√°gina: testCorrectedUnlockSystem()');
        console.log('   2. Teste manual: testAfterReload()');
        console.log('   3. Verifique se a Chuva de Flechas est√° vis√≠vel no jogo');
    };

    // Executar automaticamente o teste do sistema corrigido ap√≥s inicializa√ß√£o
    setTimeout(() => {
        if (typeof window.testAfterReload === 'function') {
            console.log('üß™ Executando teste autom√°tico do sistema corrigido...');
            window.testAfterReload();
        }
    }, 12000);
    
    // Mostrar resumo da corre√ß√£o ap√≥s 13 segundos
    setTimeout(() => {
        if (typeof window.showCriticalFixSummary === 'function') {
            console.log('üõ†Ô∏è Exibindo resumo da corre√ß√£o cr√≠tica...');
            window.showCriticalFixSummary();
        }
    }, 13000);

    // FUN√á√ïES DE TESTE PARA SISTEMA DE CONTINUAR
    
    // Fun√ß√£o para testar o sistema de continuar completo
    window.testContinueSystem = function() {
        console.log('üéÆ TESTE COMPLETO DO SISTEMA DE CONTINUAR');
        console.log('=========================================');
        
        // Verificar localStorage
        const savedWave = localStorage.getItem('maiorOndaAtingida');
        console.log(`üìä Maior onda salva: ${savedWave || 'nenhuma'}`);
        
        // Verificar elementos HTML
        const btnContinue = document.getElementById('btnContinue');
        const btnContinueGameOver = document.getElementById('btnContinueGameOver');
        
        console.log('üîç Elementos HTML:');
        console.log(`   Bot√£o menu principal: ${btnContinue ? '‚úÖ existe' : '‚ùå n√£o encontrado'}`);
        console.log(`   Bot√£o game over: ${btnContinueGameOver ? '‚úÖ existe' : '‚ùå n√£o encontrado'}`);
        
        if (btnContinue) {
            console.log(`   Display: ${btnContinue.style.display}`);
            console.log(`   Conte√∫do: ${btnContinue.innerHTML}`);
        }
        
        // Verificar fun√ß√µes
        console.log('üîß Fun√ß√µes dispon√≠veis:');
        console.log(`   adicionarBotaoContinuarMenu: ${typeof window.adicionarBotaoContinuarMenu === 'function' ? '‚úÖ' : '‚ùå'}`);
        console.log(`   iniciarModoContinuar: ${typeof window.iniciarModoContinuar === 'function' ? '‚úÖ' : '‚ùå'}`);
        console.log(`   adicionarBotaoContinuarGameOver: ${typeof window.adicionarBotaoContinuarGameOver === 'function' ? '‚úÖ' : '‚ùå'}`);
        
        // Verificar GameSystem
        if (window.gameSystem) {
            console.log(`   GameSystem.saveMaxWaveReached: ${typeof window.gameSystem.saveMaxWaveReached === 'function' ? '‚úÖ' : '‚ùå'}`);
        }
        
        console.log('');
        console.log('üß™ FUN√á√ïES DE TESTE DISPON√çVEIS:');
        console.log('   simulateContinueProgress(wave) - Simular progresso at√© onda X');
        console.log('   forceContinueButton() - For√ßar apari√ß√£o do bot√£o');
        console.log('   testContinueFlow() - Testar fluxo completo');
        console.log('   clearContinueProgress() - Limpar progresso salvo');
    };
    
    // Fun√ß√£o para simular progresso
    window.simulateContinueProgress = function(targetWave = 5) {
        console.log(`üéØ Simulando progresso at√© onda ${targetWave}...`);
        
        localStorage.setItem('maiorOndaAtingida', targetWave.toString());
        console.log(`‚úÖ Progresso salvo: onda ${targetWave}`);
        
        // Atualizar bot√£o
        if (typeof window.adicionarBotaoContinuarMenu === 'function') {
            window.adicionarBotaoContinuarMenu();
            console.log('‚úÖ Bot√£o atualizado');
        }
        
        // Verificar resultado
        const btn = document.getElementById('btnContinue');
        if (btn && btn.style.display !== 'none') {
            console.log('‚úÖ Bot√£o "Continuar" agora est√° vis√≠vel!');
        } else {
            console.log('‚ùå Bot√£o "Continuar" ainda n√£o est√° vis√≠vel');
        }
    };
    
    // Fun√ß√£o para for√ßar apari√ß√£o do bot√£o
    window.forceContinueButton = function() {
        console.log('üîß For√ßando apari√ß√£o do bot√£o "Continuar"...');
        
        const btn = document.getElementById('btnContinue');
        if (btn) {
            btn.style.display = 'flex';
            btn.innerHTML = `Continuar<br><span class="onda-info">(Onda 5)</span>`;
            console.log('‚úÖ Bot√£o for√ßado a aparecer');
        } else {
            console.log('‚ùå Bot√£o n√£o encontrado');
        }
    };
    
    // Fun√ß√£o para testar fluxo completo
    window.testContinueFlow = function() {
        console.log('üéÆ TESTANDO FLUXO COMPLETO DO SISTEMA DE CONTINUAR');
        console.log('================================================');
        
        // Passo 1: Simular progresso
        console.log('üìà Passo 1: Simulando progresso...');
        window.simulateContinueProgress(10);
        
        // Passo 2: Verificar se bot√£o aparece
        setTimeout(() => {
            console.log('üîç Passo 2: Verificando bot√£o...');
            const btn = document.getElementById('btnContinue');
            if (btn && btn.style.display !== 'none') {
                console.log('‚úÖ Bot√£o vis√≠vel! Testando clique...');
                
                // Passo 3: Testar clique (simular)
                console.log('üñ±Ô∏è Passo 3: Testando funcionalidade...');
                if (typeof window.iniciarModoContinuar === 'function') {
                    console.log('‚úÖ Fun√ß√£o iniciarModoContinuar encontrada');
                    console.log('üí° Para testar completamente, clique no bot√£o "Continuar"');
                } else {
                    console.log('‚ùå Fun√ß√£o iniciarModoContinuar n√£o encontrada');
                }
            } else {
                console.log('‚ùå Bot√£o n√£o est√° vis√≠vel');
            }
        }, 500);
    };
    
    // Fun√ß√£o para limpar progresso
    window.clearContinueProgress = function() {
        console.log('üóëÔ∏è Limpando progresso do sistema de continuar...');
        localStorage.removeItem('maiorOndaAtingida');
        
        // Atualizar bot√£o
        if (typeof window.adicionarBotaoContinuarMenu === 'function') {
            window.adicionarBotaoContinuarMenu();
        }
        
        console.log('‚úÖ Progresso limpo');
    };

    // Executar teste autom√°tico do sistema de continuar ap√≥s 15 segundos
    setTimeout(() => {
        if (typeof window.testContinueSystem === 'function') {
            console.log('üéÆ Executando teste autom√°tico do sistema de continuar...');
            window.testContinueSystem();
        }
    }, 15000);

    // Fun√ß√£o para mostrar resumo das corre√ß√µes do sistema de continuar
    window.showContinueSystemFixSummary = function() {
        console.log('üõ†Ô∏è RESUMO DAS CORRE√á√ïES - SISTEMA DE CONTINUAR');
        console.log('=============================================');
        console.log('');
        console.log('üêõ PROBLEMA IDENTIFICADO:');
        console.log('   - Sistema de continuar parou de funcionar');
        console.log('   - Maior onda n√£o estava sendo salva quando jogador perdia');
        console.log('   - Bot√£o "Continuar" n√£o aparecia no menu principal');
        console.log('   - Inicializa√ß√£o do sistema estava desabilitada');
        console.log('');
        console.log('üîß CORRE√á√ïES APLICADAS:');
        console.log('   1. Adicionado saveMaxWaveReached() no GameSystem.js');
        console.log('   2. Integrado salvamento autom√°tico no m√©todo gameOver()');
        console.log('   3. Reabilitado inicializa√ß√£o do bot√£o "Continuar"');
        console.log('   4. Adicionado fun√ß√µes de teste e debug');
        console.log('');
        console.log('‚úÖ FUNCIONALIDADES RESTAURADAS:');
        console.log('   - Salvamento autom√°tico da maior onda ao perder');
        console.log('   - Bot√£o "Continuar" aparece no menu principal');
        console.log('   - Bot√£o "Continuar" na tela de game over');
        console.log('   - Carregamento com ouro acumulado calculado');
        console.log('   - In√≠cio na onda correspondente ao progresso');
        console.log('');
        console.log('üéØ COMO TESTAR:');
        console.log('   1. simulateContinueProgress(10) - Simular progresso');
        console.log('   2. Verificar se bot√£o aparece no menu');
        console.log('   3. Clicar no bot√£o para testar funcionalidade');
        console.log('   4. Alternativamente: jogue at√© perder e veja se salva');
        console.log('');
        console.log('üèÜ SISTEMA DE CONTINUAR RESTAURADO E FUNCIONAL!');
    };

    // Mostrar resumo das corre√ß√µes ap√≥s 16 segundos
    setTimeout(() => {
        if (typeof window.showContinueSystemFixSummary === 'function') {
            console.log('üõ†Ô∏è Exibindo resumo das corre√ß√µes do sistema de continuar...');
            window.showContinueSystemFixSummary();
        }
    }, 16000);

    // FUN√á√ïES DE TESTE PARA NOVO JOGO vs CONTINUAR
    
    // Fun√ß√£o para testar a diferen√ßa entre novo jogo e continuar
    window.testNewGameVsContinue = function() {
        console.log('üéÆ TESTE: NOVO JOGO vs CONTINUAR');
        console.log('================================');
        
        // Verificar fun√ß√µes dispon√≠veis
        console.log('üîß Fun√ß√µes dispon√≠veis:');
        console.log(`   iniciarNovoJogo: ${typeof window.iniciarNovoJogo === 'function' ? '‚úÖ' : '‚ùå'}`);
        console.log(`   iniciarModoContinuar: ${typeof window.iniciarModoContinuar === 'function' ? '‚úÖ' : '‚ùå'}`);
        
        // Verificar estado atual
        if (window.gameSystem && window.gameSystem.gameState) {
            const gs = window.gameSystem.gameState;
            console.log('');
            console.log('üìä Estado atual do jogo:');
            console.log(`   Onda: ${gs.wave}`);
            console.log(`   Ouro: ${gs.gold}`);
            console.log(`   Vida: ${gs.health}`);
            console.log(`   Pontua√ß√£o: ${gs.score}`);
            console.log(`   Torres: ${gs.towers.length}`);
        }
        
        // Verificar progresso salvo
        const savedWave = localStorage.getItem('maiorOndaAtingida');
        console.log('');
        console.log('üíæ Progresso salvo:');
        console.log(`   Maior onda: ${savedWave || 'nenhuma'}`);
        
        console.log('');
        console.log('üß™ FUN√á√ïES DE TESTE:');
        console.log('   testNewGameButton() - Testar bot√£o "Jogar"');
        console.log('   testContinueButton() - Testar bot√£o "Continuar"');
        console.log('   compareGameStates() - Comparar estados ap√≥s cada teste');
    };
    
    // Fun√ß√£o para testar especificamente o bot√£o "Jogar"
    window.testNewGameButton = function() {
        console.log('üÜï TESTANDO BOT√ÉO "JOGAR" (NOVO JOGO)');
        console.log('====================================');
        
        // Salvar estado antes do teste
        let stateBefore = null;
        if (window.gameSystem && window.gameSystem.gameState) {
            stateBefore = {
                wave: window.gameSystem.gameState.wave,
                gold: window.gameSystem.gameState.gold,
                health: window.gameSystem.gameState.health,
                score: window.gameSystem.gameState.score
            };
            console.log('üìä Estado ANTES:', stateBefore);
        }
        
        // Testar fun√ß√£o iniciarNovoJogo
        if (typeof window.iniciarNovoJogo === 'function') {
            console.log('üéÆ Executando iniciarNovoJogo()...');
            window.iniciarNovoJogo();
            
            // Verificar estado ap√≥s
            setTimeout(() => {
                if (window.gameSystem && window.gameSystem.gameState) {
                    const stateAfter = {
                        wave: window.gameSystem.gameState.wave,
                        gold: window.gameSystem.gameState.gold,
                        health: window.gameSystem.gameState.health,
                        score: window.gameSystem.gameState.score
                    };
                    console.log('üìä Estado DEPOIS:', stateAfter);
                    
                    // Verificar se √© realmente um novo jogo
                    const isNewGame = (
                        stateAfter.wave === 0 &&
                        stateAfter.score === 0 &&
                        stateAfter.health > 0 &&
                        stateAfter.gold > 0
                    );
                    
                    console.log(`${isNewGame ? '‚úÖ' : '‚ùå'} ${isNewGame ? 'NOVO JOGO CRIADO CORRETAMENTE' : 'ERRO: N√£o √© um novo jogo'}`);
                }
            }, 500);
        } else {
            console.log('‚ùå Fun√ß√£o iniciarNovoJogo n√£o encontrada');
        }
    };
    
    // Fun√ß√£o para testar especificamente o bot√£o "Continuar"
    window.testContinueButton = function() {
        console.log('üîÑ TESTANDO BOT√ÉO "CONTINUAR" (MODO CONTINUAR)');
        console.log('=============================================');
        
        // Primeiro simular progresso
        const testWave = 5;
        localStorage.setItem('maiorOndaAtingida', testWave.toString());
        console.log(`üìà Progresso simulado: onda ${testWave}`);
        
        // Testar fun√ß√£o iniciarModoContinuar
        if (typeof window.iniciarModoContinuar === 'function') {
            console.log('üéÆ Executando iniciarModoContinuar()...');
            window.iniciarModoContinuar();
            
            // Verificar estado ap√≥s
            setTimeout(() => {
                if (window.gameSystem && window.gameSystem.gameState) {
                    const stateAfter = {
                        wave: window.gameSystem.gameState.wave,
                        gold: window.gameSystem.gameState.gold,
                        health: window.gameSystem.gameState.health,
                        score: window.gameSystem.gameState.score
                    };
                    console.log('üìä Estado do modo continuar:', stateAfter);
                    
                    // Verificar se √© modo continuar
                    const isContinueMode = (
                        stateAfter.wave >= testWave - 1 &&
                        stateAfter.gold > 200 // Deve ter ouro acumulado
                    );
                    
                    console.log(`${isContinueMode ? '‚úÖ' : '‚ùå'} ${isContinueMode ? 'MODO CONTINUAR FUNCIONANDO' : 'ERRO: Modo continuar n√£o funcionou'}`);
                }
            }, 500);
        } else {
            console.log('‚ùå Fun√ß√£o iniciarModoContinuar n√£o encontrada');
        }
    };
    
    // Fun√ß√£o para comparar estados
    window.compareGameStates = function() {
        console.log('üìä COMPARA√á√ÉO DE ESTADOS');
        console.log('========================');
        
        console.log('üÜï Para testar NOVO JOGO:');
        console.log('   1. Execute: testNewGameButton()');
        console.log('   2. Observe que wave=0, score=0, ouro inicial');
        console.log('');
        console.log('üîÑ Para testar CONTINUAR:');
        console.log('   1. Execute: testContinueButton()');
        console.log('   2. Observe que wave>=4, ouro acumulado');
        console.log('');
        console.log('‚úÖ Diferen√ßa esperada:');
        console.log('   Novo jogo: Tudo zerado, ouro inicial');
        console.log('   Continuar: Onda avan√ßada, muito ouro');
    };

    // Executar teste autom√°tico dos bot√µes ap√≥s 17 segundos
    setTimeout(() => {
        if (typeof window.testNewGameVsContinue === 'function') {
            console.log('üéÆ Executando teste autom√°tico dos bot√µes...');
            window.testNewGameVsContinue();
        }
    }, 17000);

    // Fun√ß√£o para mostrar resumo da corre√ß√£o do novo jogo
    window.showNewGameFixSummary = function() {
        console.log('üõ†Ô∏è RESUMO DA CORRE√á√ÉO - BOT√ÉO "JOGAR"');
        console.log('===================================');
        console.log('');
        console.log('üêõ PROBLEMA IDENTIFICADO:');
        console.log('   - Bot√£o "Jogar" n√£o iniciava jogo novo');
        console.log('   - Apenas iniciava game loop com estado anterior');
        console.log('   - Comportamento igual ao bot√£o "Continuar"');
        console.log('   - Usu√°rio n√£o conseguia come√ßar jogo limpo');
        console.log('');
        console.log('üîß CORRE√á√ïES APLICADAS:');
        console.log('   1. Criado fun√ß√£o iniciarNovoJogo() no game.js');
        console.log('   2. Modificado event listener do bot√£o "Jogar"');
        console.log('   3. Fun√ß√£o usa getInitialGameState() para estado limpo');
        console.log('   4. Adicionado fallback para compatibilidade');
        console.log('');
        console.log('‚úÖ FUNCIONALIDADES RESTAURADAS:');
        console.log('   - Bot√£o "Jogar" ‚Üí Novo jogo (wave=0, score=0)');
        console.log('   - Bot√£o "Continuar" ‚Üí Modo continuar (wave salva)');
        console.log('   - Estados completamente diferentes e corretos');
        console.log('   - Restart completo do gameSystem no novo jogo');
        console.log('');
        console.log('üéØ COMO TESTAR:');
        console.log('   1. testNewGameButton() - Verificar novo jogo');
        console.log('   2. testContinueButton() - Verificar continuar');
        console.log('   3. Clique nos bot√µes do menu para testar visual');
        console.log('');
        console.log('üèÜ DIFERENCIA√á√ÉO NOVO JOGO vs CONTINUAR RESTAURADA!');
    };

    // Mostrar resumo da corre√ß√£o ap√≥s 18 segundos
    setTimeout(() => {
        if (typeof window.showNewGameFixSummary === 'function') {
            console.log('üõ†Ô∏è Exibindo resumo da corre√ß√£o do novo jogo...');
            window.showNewGameFixSummary();
        }
    }, 18000);

    </script>
</body>
</html> 