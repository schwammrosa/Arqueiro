<!DOCTYPE html>

<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Legado da Fortaleza</title>
    <link rel="icon" type="image/x-icon" href="assets/imagen/favicon.ico">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="skill-tree.css">
    <link rel="stylesheet" href="config-style.css">
    <style>
        /* Estilos espec√≠ficos para o jogo principal */
        .game-container {
            position: relative;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="top-panel">
            <div class="stats">
                <div class="stat">
                    <span class="label">Vida:</span>
                    <span id="health" class="value">20</span>
                </div>
                <div class="stat">
                    <span class="label">Ouro:</span>
                    <span id="gold" class="value">100</span>
                </div>
                <div class="stat">
                    <span class="label">Onda:</span>
                    <span id="wave" class="value">1</span>
                </div>
                <div class="stat">
                    <span class="label">Monstros:</span>
                    <span id="monsters" class="value">0/0</span>
                </div>
                <div class="stat">
                    <span class="label">Tempo:</span>
                    <span id="gameTime" class="value">00:00</span>
                </div>
                <div class="stat">
                    <span class="label">Pr√≥xima Onda:</span>
                    <span id="nextWaveTimer" class="value">--</span>
                </div>
                <div class="stat">
                    <span class="label">Pontos:</span>
                    <span id="score" class="value">0</span>
                </div>
                <div class="stat">
                    <span class="label">Velocidade:</span>
                    <span id="gameSpeed" class="value">1x</span>
            </div>
        </div>
        
        <!-- Barra de controles -->
            <div class="horizontal-controls">
                <button id="start-wave" class="control-btn" title="Iniciar pr√≥xima onda">
                    <span class="btn-icon">‚ñ∂Ô∏è</span>
                    <span class="btn-text">PR√ìXIMA ONDA</span>
                </button>
                <button id="pause" class="control-btn" title="Pausar/Continuar jogo">
                    <span class="btn-icon">‚è∏Ô∏è</span>
                    <span class="btn-text">Continuar</span>
                </button>
                <button id="speedButton" class="control-btn speed-btn" title="Alterar velocidade do jogo (1x)">
                    <span class="btn-icon">‚ö°</span>
                    <span class="btn-text">1x</span>
                </button>
                <a href="config.html" class="control-btn config-btn" title="Configura√ß√µes do jogo">
                    <span class="btn-icon">‚öôÔ∏è</span>
                    <span class="btn-text">Configura√ß√£o</span>
                </a>
                <button id="btnUpgrades" class="control-btn upgrade-btn" title="√Årvore de habilidades">
                    <span class="btn-icon">‚≠ê</span>
                    <span class="btn-text">Upgrades</span>
                </button>
                <button id="btnBackToMenu" class="control-btn menu-btn" title="Voltar ao menu principal">
                    <span class="btn-icon">üè†</span>
                    <span class="btn-text">Menu Principal</span>
                </button>
            </div>
        </div>
        
        <div class="game-content">
            <canvas id="gameCanvas"></canvas>
        <div class="game-over" id="gameOver" style="display: none;">
            <div class="game-over-content">
                <h2>Game Over!</h2>
                <p>Voc√™ sobreviveu a <span id="final-wave">0</span> ondas!</p>
                <button id="restart" class="btn">Voltar ao Menu</button>
            </div>
        </div>

        <!-- Painel de informa√ß√µes da torre -->
        <div class="tower-info-panel" id="towerInfoPanel" style="display: none;">
            <div class="tower-info-content">
                <div class="tower-header">
                    <div class="tower-icon-display" id="towerIconDisplay">üèπ</div>
                    <div class="tower-title">
                        <h3 id="towerInfoTitle">Arqueiro</h3>
                        <span class="tower-level">N√≠vel <span id="towerLevel">1</span></span>
                    </div>
                    <button id="closeTowerInfo" class="close-tower-btn">√ó</button>
                </div>
                
                <div class="tower-stats-grid">
                    <div class="stat-item">
                        <span class="stat-icon">‚öîÔ∏è</span>
                        <span class="stat-label">Dano</span>
                        <span class="stat-value" id="towerDamage">15</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">üéØ</span>
                        <span class="stat-label">Alcance</span>
                        <span class="stat-value" id="towerRange">120</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">‚ö°</span>
                        <span class="stat-label">Velocidade</span>
                        <span class="stat-value" id="towerFireRate">1.0s</span>
                    </div>
                </div>
                
                <div class="tower-actions">
                    <button id="upgradeTower" class="action-btn upgrade-btn">
                        <span class="btn-icon">‚¨ÜÔ∏è</span>
                        <span class="btn-text">Evoluir</span>
                        <span class="btn-cost" id="upgradeCost">50</span>
                    </button>
                    <button id="sellTower" class="action-btn sell-btn">
                        <span class="btn-icon">üí∞</span>
                        <span class="btn-text">Vender</span>
                        <span class="btn-cost" id="sellValue">25</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Container para habilidades e torres lado a lado -->
        <div class="bottom-panel">
            <!-- Habilidade Esquerda -->
            <button id="btnArrowRain" class="special-skill-btn skill-left" title="Chuva de Flechas">
                <span class="skill-icon">üèπ</span>
                <span class="skill-label">Chuva de Flechas</span>
                <span class="skill-cooldown" id="arrowRainCooldown"></span>
            </button>
            
            <!-- Torres no Centro -->
            <div class="footer-tower-bar" id="footerTowerBar">
                <!-- As op√ß√µes de torres ser√£o geradas dinamicamente pelo JS -->
            </div>
            
            <!-- Habilidade Direita -->
            <button id="btnIceStorm" class="special-skill-btn skill-right" title="Tempestade de Gelo">
                <span class="skill-icon">‚ùÑÔ∏è</span>
                <span class="skill-label">Tempestade de Gelo</span>
                <span class="skill-cooldown" id="iceStormCooldown"></span>
            </button>
        </div>
    </div>
    
    <script src="game.js" type="module"></script>
    <script src="config.js" type="module"></script>


    <div id="infoTooltip" class="info-tooltip" style="display:none;"></div>
    


    <!-- Painel/modal de upgrades -->
    <div id="upgradeModal" class="upgrade-modal" style="display:none;">
        <div class="upgrade-modal-content">
            <div class="upgrade-header">
                <h2>üîÆ Upgrades Globais</h2>
                <span id="closeUpgradeModal" class="upgrade-close">&times;</span>
            </div>
            <div class="upgrade-points-info">
                <span class="upgrade-points-label">Pontos dispon√≠veis:</span> <span id="upgradePoints" class="upgrade-points-value">0</span>
            </div>
            <div id="upgradeList" class="upgrade-list"></div>
        </div>
    </div>

    <div id="mainMenu" class="main-menu-overlay">
        <div class="main-menu-content">
            <h1 class="main-menu-title">Legado da Fortaleza</h1>
            <p style="color: #4fdfff; text-align: center; margin-bottom: 20px; font-size: 1.1em;">
                Modo Infinito - Sobreviva o m√°ximo de ondas poss√≠vel!
            </p>
            <button id="btnPlay" class="main-menu-btn">Jogar</button>
            <button id="btnContinue" class="main-menu-btn btn-continue" style="display: none;">
                <span class="continue-text">Continuar</span>
                <span class="continue-wave">(onda 1)</span>
            </button>
            <button id="btnTutorial" class="main-menu-btn">üìö Tutorial</button>
            <button id="btnMenuConfig" class="main-menu-btn">Configura√ß√µes</button>
            <button id="btnMenuCredits" class="main-menu-btn">Cr√©ditos</button>
        </div>
    </div>

    <!-- Modal de Sele√ß√£o de Dificuldade -->
    <div id="difficultyModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 99999; display: none; justify-content: center; align-items: center;">
        <div style="background: #1e293b; padding: 40px; border-radius: 20px; max-width: 500px; width: 90%; color: white; text-align: center;">
            <h2 id="difficultyModalTitle" style="margin-bottom: 30px; color: #4fdfff;">Selecione a Dificuldade</h2>
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <button id="btnEasy" onclick="selectDifficulty('easy')" style="padding: 15px; border: 2px solid #00ff00; background: rgba(0, 255, 0, 0.1); border-radius: 10px; color: white; cursor: pointer; font-size: 16px;">
                    üü¢ F√°cil - Mais vida, mais ouro, inimigos mais fracos
                    <div style="font-size: 12px; color: #4fdfff; margin-top: 5px;">Template: Labirinto</div>
                    <div id="progressEasy" style="display: none; margin-top: 5px; color: #4fdfff;"></div>
                </button>
                <button id="btnNormal" onclick="selectDifficulty('normal')" style="padding: 15px; border: 2px solid #ffff00; background: rgba(255, 255, 0, 0.1); border-radius: 10px; color: white; cursor: pointer; font-size: 16px;">
                    üü° Normal - Configura√ß√µes balanceadas
                    <div style="font-size: 12px; color: #4fdfff; margin-top: 5px;">Template: Zigzag</div>
                    <div id="progressNormal" style="display: none; margin-top: 5px; color: #4fdfff;"></div>
                </button>
                <button id="btnHard" onclick="selectDifficulty('hard')" style="padding: 15px; border: 2px solid #ff0000; background: rgba(255, 0, 0, 0.1); border-radius: 10px; color: white; cursor: pointer; font-size: 16px;">
                    üî¥ Dif√≠cil - Menos vida, menos ouro, inimigos mais fortes
                    <div style="font-size: 12px; color: #4fdfff; margin-top: 5px;">Template: Linha Reta</div>
                    <div id="progressHard" style="display: none; margin-top: 5px; color: #4fdfff;"></div>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal do Tutorial -->
    <div id="tutorialModal" class="tutorial-modal" style="display:none;">
        <div class="tutorial-modal-content">
            <span id="closeTutorialModal" class="tutorial-close">&times;</span>
            <div class="tutorial-header">
                <h2>üìö Tutorial - Legado da Fortaleza</h2>
                <div class="tutorial-progress">
                    <span id="tutorialStep">1</span> de <span id="tutorialTotal">6</span>
                </div>
            </div>
            
            <div class="tutorial-content">
                <div id="tutorialStep1" class="tutorial-step active">
                    <div class="tutorial-icon">üéØ</div>
                    <h3>Bem-vindo ao Legado da Fortaleza!</h3>
                    <p>Este √© um jogo de Tower Defense onde voc√™ deve defender sua fortaleza contra ondas de inimigos. Vamos aprender os conceitos b√°sicos!</p>
                    <div class="tutorial-tip">
                        <strong>üí° Dica:</strong> Voc√™ come√ßa com 100 de vida e 50 de ouro. Se sua vida chegar a 0, o jogo acaba!
                    </div>
                </div>
                
                <div id="tutorialStep2" class="tutorial-step">
                    <div class="tutorial-icon">üè∞</div>
                    <h3>Colocando Torres</h3>
                    <p>Para defender sua fortaleza, voc√™ precisa colocar torres no mapa. Clique em uma torre na barra inferior e depois clique onde quer coloc√°-la no mapa.</p>
                    <div class="tutorial-tip">
                        <strong>üí° Dica:</strong> Cada torre tem um custo diferente. O Arqueiro custa 25 ouro, o Canh√£o 50 ouro e a Torre Especial 100 ouro.
                    </div>
                </div>
                
                <div id="tutorialStep3" class="tutorial-step">
                    <div class="tutorial-icon">‚¨ÜÔ∏è</div>
                    <h3>Evoluindo Torres</h3>
                    <p>Clique em uma torre colocada para ver suas informa√ß√µes. Voc√™ pode evolu√≠-la para aumentar dano, alcance e velocidade de tiro.</p>
                    <div class="tutorial-tip">
                        <strong>üí° Dica:</strong> Torres evolu√≠das s√£o muito mais eficientes! Sempre evolua suas torres quando poss√≠vel.
                    </div>
                </div>
                
                <div id="tutorialStep4" class="tutorial-step">
                    <div class="tutorial-icon">üèπ</div>
                    <h3>Habilidades Especiais</h3>
                    <p>Voc√™ tem duas habilidades especiais: Chuva de Flechas e Tempestade de Gelo. Use-as estrategicamente para derrotar inimigos dif√≠ceis.</p>
                    <div class="tutorial-tip">
                        <strong>üí° Dica:</strong> A Chuva de Flechas causa dano em √°rea, enquanto a Tempestade de Gelo desacelera os inimigos.
                    </div>
                </div>
                
                <div id="tutorialStep5" class="tutorial-step">
                    <div class="tutorial-icon">‚ö°</div>
                    <h3>Gerenciando Ondas</h3>
                    <p>Clique em "Iniciar Onda" para come√ßar uma nova onda de inimigos. Cada onda fica mais dif√≠cil, mas voc√™ ganha mais ouro.</p>
                    <div class="tutorial-tip">
                        <strong>üí° Dica:</strong> Prepare-se bem antes de iniciar uma onda. √â melhor ter torres evolu√≠das do que muitas torres fracas.
                    </div>
                </div>
                
                <div id="tutorialStep6" class="tutorial-step">
                    <div class="tutorial-icon">üéÆ</div>
                    <h3>Dificuldades e Progresso</h3>
                    <p>Escolha entre F√°cil, Normal ou Dif√≠cil. Cada dificuldade tem configura√ß√µes diferentes e salva seu progresso separadamente.</p>
                    <div class="tutorial-tip">
                        <strong>üí° Dica:</strong> Comece no modo F√°cil para aprender o jogo, depois experimente as outras dificuldades!
                    </div>
                </div>
            </div>
            
            <div class="tutorial-navigation">
                <button id="tutorialPrev" class="tutorial-nav-btn">‚Üê Anterior</button>
                <button id="tutorialNext" class="tutorial-nav-btn">Pr√≥ximo ‚Üí</button>
                <button id="tutorialFinish" class="tutorial-nav-btn tutorial-finish" style="display:none;">Finalizar Tutorial</button>
            </div>
        </div>
    </div>

    <div id="creditsModal" class="main-menu-modal" style="display:none;">
        <div class="main-menu-modal-content">
            <span id="closeCreditsModal" class="main-menu-close">&times;</span>
            <h2>Cr√©ditos</h2>
            <p><strong>Desenvolvido por:</strong> Robson Schwamm Rosa<br>
            <strong>Nome do Jogo:</strong> Legado da Fortaleza<br>
            <strong>Tecnologias utilizadas:</strong> JavaScript, HTML5 Canvas, CSS3<br>
            <strong>Design e Programa√ß√£o:</strong> Robson Schwamm Rosa<br>
            <strong>Inspira√ß√£o:</strong> Jogos cl√°ssicos de Tower Defense<br>
            <strong>Finalidade:</strong> Projeto independente para estudo, aprendizado e divers√£o</p>
        </div>
    </div>

    <style>
    /* NOVO LAYOUT REORGANIZADO */
    
    /* Estrutura otimizada para novo layout */
    .game-content {
        flex-grow: 1 !important;
        position: relative !important;
        width: 100% !important;
        display: flex !important;
        flex-direction: column !important;
        padding: 10px !important;
    }
    
    /* Canvas otimizado para nova estrutura */
    #gameCanvas {
        margin: 0 auto !important;
        display: block !important;
        position: relative !important;
        z-index: 1 !important;
        background: #0a0e17 !important;
        border-radius: 8px !important;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
    }
    

    

    

    

    

    

    /* Bot√£o toggle flutuante para esconder/mostrar controles */
    .toggle-controls-btn {
        position: fixed !important;
        top: 50% !important;
        right: 20px !important;
        transform: translateY(-50%) !important;
        width: 40px !important;
        height: 40px !important;
        background: linear-gradient(135deg, #1f2937, #111827) !important;
        border: 2px solid rgba(255, 255, 255, 0.2) !important;
        border-radius: 50% !important;
        color: #ffffff !important;
        cursor: pointer !important;
        font-size: 12px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        transition: all 0.3s ease !important;
        z-index: 1000 !important;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4) !important;
        backdrop-filter: blur(10px) !important;
    }
    
    .toggle-controls-btn:hover {
        background: linear-gradient(135deg, #374151, #1f2937) !important;
        border-color: rgba(255, 255, 255, 0.4) !important;
        transform: translateY(-50%) scale(1.1) !important;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5) !important;
    }
    
    .toggle-controls-btn:active {
        transform: translateY(-50%) scale(0.95) !important;
    }
    
    .toggle-icon {
        transition: transform 0.3s ease !important;
        font-size: 10px !important;
    }
    

    
    .controls-hidden .toggle-controls-btn {
        opacity: 0.8 !important;
    }
    
    .controls-hidden .toggle-icon {
        transform: rotate(180deg) !important;
    }
    
    /* Top panel - estrutura principal */
    .top-panel {
        position: relative !important;
        background: linear-gradient(135deg, #1f2937 0%, #374151 100%) !important;
        border-bottom: 2px solid rgba(79, 172, 254, 0.3) !important;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
    }
    
    /* Controlar menu principal */
    #mainMenu {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        z-index: 10000 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        background: linear-gradient(135deg, #181c24 80%, #4fdfff 100%) !important;
        padding: 0 !important;
        margin: 0 !important;
    }
    
    /* Esconder o menu quando o jogo est√° rodando */
    body.game-running #mainMenu {
        display: none !important;
    }
    
    /* Habilidades especiais centralizadas entre canvas e torres */
    #specialSkillsFixedBar,
    .skills-container {
        display: flex !important;
        justify-content: center !important;
        align-items: center !important;
        gap: 20px !important;
        padding: 15px 20px !important;
        background: rgba(30, 41, 59, 0.5) !important;
        border-top: 1px solid rgba(255, 255, 255, 0.1) !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
        margin: 10px 0 !important;
    }
    
    #btnArrowRain {
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 4px !important;
        width: 80px !important;
        height: 80px !important;
        border-radius: 50% !important;
        background: linear-gradient(135deg, #e74c3c, #c0392b) !important;
        border: 2px solid rgba(255, 255, 255, 0.2) !important;
        color: white !important;
        font-weight: 600 !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3) !important;
    }
    
    #btnArrowRain:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4) !important;
    }
    
    #btnIceStorm {
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 4px !important;
        width: 80px !important;
        height: 80px !important;
        border-radius: 50% !important;
        background: linear-gradient(135deg, #3498db, #2980b9) !important;
        border: 2px solid rgba(255, 255, 255, 0.2) !important;
        color: white !important;
        font-weight: 600 !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3) !important;
    }
    
    #btnIceStorm:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4) !important;
    }
    

    
    /* Responsividade para tablets */
    @media (max-width: 768px) {
        

        
        #btnArrowRain, #btnIceStorm {
            width: 120px !important;
            height: 60px !important;
        }
        
        #specialSkillsFixedBar,
        .skills-container {
            gap: 10px !important;
            padding: 10px !important;
        }
    }
    
    /* Responsividade para celular - APENAS √çCONES */
    @media (max-width: 480px) {
        

        
        /* Habilidades especiais menores no celular */
        #btnArrowRain, #btnIceStorm {
            width: 100px !important;
            height: 50px !important;
        }
        

        

    }
    
    @keyframes tooltipShow {
        from {
            opacity: 0;
            transform: translateX(-50%) translateY(4px);
        }
        to {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
    }
    
    /* Estilos visuais melhorados para o menu principal */
    .main-menu-overlay {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%) !important;
        backdrop-filter: blur(10px) !important;
    }
    
        .main-menu-content {
        background: rgba(30, 41, 59, 0.95) !important;
        border: 2px solid rgba(79, 223, 255, 0.3) !important;
        border-radius: 20px !important;
        padding: 50px 40px !important;
        box-shadow: 
            0 25px 50px -12px rgba(0, 0, 0, 0.8),
            0 0 100px rgba(79, 223, 255, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
        backdrop-filter: blur(20px) !important;
        max-width: 450px !important;
        width: 90% !important;
        animation: menuSlideIn 0.6s ease-out !important;
        }
        
        .main-menu-title {
        font-size: 3em !important;
        font-weight: 900 !important;
        background: linear-gradient(135deg, #4fdfff 0%, #06b6d4 50%, #0891b2 100%) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
        text-align: center !important;
        margin-bottom: 10px !important;
        text-shadow: 0 4px 20px rgba(79, 223, 255, 0.3) !important;
        letter-spacing: 2px !important;
        }
        
        .main-menu-btn {
        width: 100% !important;
        padding: 18px 30px !important;
        margin: 12px 0 !important;
        background: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #60a5fa 100%) !important;
        border: 2px solid rgba(59, 130, 246, 0.3) !important;
        border-radius: 12px !important;
        color: white !important;
        font-size: 1.2em !important;
        font-weight: 700 !important;
        cursor: pointer !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        text-transform: uppercase !important;
        letter-spacing: 1px !important;
        position: relative !important;
        overflow: hidden !important;
        box-shadow: 
            0 10px 20px rgba(30, 64, 175, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
    }
    
    /* Bot√£o Continuar com duas linhas */
    .btn-continue {
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        gap: 4px !important;
        padding: 16px 30px !important;
    }
    
    .continue-text {
        font-size: 1.2em !important;
        font-weight: 700 !important;
        text-transform: uppercase !important;
        letter-spacing: 1px !important;
    }
    
    .continue-wave {
        font-size: 0.9em !important;
        font-weight: 400 !important;
        text-transform: none !important;
        letter-spacing: 0.5px !important;
        opacity: 0.8 !important;
    }
    
    .main-menu-btn::before {
        content: '' !important;
        position: absolute !important;
        top: 0 !important;
        left: -100% !important;
        width: 100% !important;
        height: 100% !important;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent) !important;
        transition: left 0.6s ease !important;
    }
    
    .main-menu-btn:hover::before {
        left: 100% !important;
    }
    
    .main-menu-btn:hover {
        background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 50%, #93c5fd 100%) !important;
        border-color: rgba(96, 165, 250, 0.6) !important;
        transform: translateY(-3px) scale(1.02) !important;
        box-shadow: 
            0 20px 40px rgba(59, 130, 246, 0.4),
            0 0 30px rgba(79, 223, 255, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.3) !important;
        }
        
        .btn-continue {
        background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%) !important;
        border-color: rgba(16, 185, 129, 0.3) !important;
        box-shadow: 
            0 10px 20px rgba(5, 150, 105, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
    }
    
    .btn-continue:hover {
        background: linear-gradient(135deg, #10b981 0%, #34d399 50%, #6ee7b7 100%) !important;
        border-color: rgba(52, 211, 153, 0.6) !important;
        box-shadow: 
            0 20px 40px rgba(16, 185, 129, 0.4),
            0 0 30px rgba(52, 211, 153, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.3) !important;
    }
    
    @keyframes menuSlideIn {
        from {
            opacity: 0;
            transform: translateY(-50px) scale(0.9);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }
    
    /* Estilos para dispositivos m√≥veis */
    @media (max-width: 768px) {
        .main-menu-content {
            padding: 40px 30px !important;
            max-width: 350px !important;
        }
        
        .main-menu-title {
            font-size: 2.5em !important;
        }
        
        .main-menu-btn {
            padding: 16px 25px !important;
            font-size: 1.1em !important;
        }
        
        .continue-text {
            font-size: 1.1em !important;
        }
        
        .continue-wave {
            font-size: 0.85em !important;
        }
    }
    
    @media (max-width: 480px) {
        /* Menu full screen no celular */
        .main-menu-content {
            padding: 40px 30px !important;
            max-width: 100% !important;
            width: 100% !important;
            height: 100vh !important;
            margin: 0 !important;
            border: none !important;
            border-radius: 0 !important;
            background: rgba(30, 41, 59, 1) !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: center !important;
            align-items: center !important;
            box-shadow: none !important;
            backdrop-filter: none !important;
        }
        
        .main-menu-title {
            font-size: 2.5em !important;
            margin-bottom: 20px !important;
        }
        
        .main-menu-btn {
            padding: 16px 20px !important;
            font-size: 1.1em !important;
            margin: 8px 0 !important;
            width: 100% !important;
            max-width: 280px !important;
        }
        
        .continue-text {
            font-size: 1.1em !important;
        }
        
        .continue-wave {
            font-size: 0.85em !important;
        }
        
        /* Bot√£o toggle responsivo para celular */
        .toggle-controls-btn {
            right: 10px !important;
            width: 35px !important;
            height: 35px !important;
            font-size: 10px !important;
        }
        
        /* Menu fullscreen no celular */
        #mainMenu {
            padding: 0 !important;
            margin: 0 !important;
        }
        
        /* Garantir que o body e html n√£o tenham margens no celular */
        html, body {
            margin: 0 !important;
            padding: 0 !important;
            overflow-x: hidden !important;
            width: 100% !important;
            height: 100% !important;
            box-sizing: border-box !important;
        }
        
        * {
            box-sizing: border-box !important;
        }
    }
    
    /* Estilos para modal de cr√©ditos */
    .main-menu-modal {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        background: rgba(0, 0, 0, 0.8) !important;
        justify-content: center !important;
        align-items: center !important;
        z-index: 10000 !important;
        backdrop-filter: blur(10px) !important;
        display: none !important;
    }
    
    .main-menu-modal.show {
        display: flex !important;
    }
    
    .main-menu-modal-content {
        background: linear-gradient(135deg, #1e293b, #334155) !important;
        padding: 40px !important;
        border-radius: 20px !important;
        max-width: 600px !important;
        width: 90% !important;
        max-height: 80vh !important;
        overflow-y: auto !important;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5) !important;
        border: 2px solid rgba(99, 102, 241, 0.3) !important;
        animation: modalSlideIn 0.3s ease-out !important;
        color: white !important;
    }
    
    .main-menu-modal-content h2 {
        margin-top: 0 !important;
        margin-bottom: 20px !important;
        color: #4fdfff !important;
        font-size: 2em !important;
        text-align: center !important;
        font-weight: 700 !important;
    }
    
    .main-menu-modal-content p {
        line-height: 1.8 !important;
        font-size: 1.1em !important;
        margin-bottom: 15px !important;
        color: #e2e8f0 !important;
    }
    
    .main-menu-modal-content strong {
        color: #4fdfff !important;
    }
    
    .main-menu-close {
        position: absolute !important;
        top: 15px !important;
        right: 25px !important;
        font-size: 30px !important;
        color: #64748b !important;
        cursor: pointer !important;
        transition: color 0.3s ease !important;
    }
    
    .main-menu-close:hover {
        color: #ef4444 !important;
    }
    
    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translateY(-50px) scale(0.9);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }
    
    /* Responsividade para modal de cr√©ditos */
    @media (max-width: 768px) {
        .main-menu-modal-content {
            padding: 30px !important;
            max-width: 95% !important;
        }
        
        .main-menu-modal-content h2 {
            font-size: 1.8em !important;
        }
        
        .main-menu-modal-content p {
            font-size: 1em !important;
        }
    }
    
    @media (max-width: 480px) {
        .main-menu-modal-content {
            padding: 25px !important;
            max-width: 98% !important;
            max-height: 85vh !important;
        }
        
        .main-menu-modal-content h2 {
            font-size: 1.6em !important;
        }
        
        .main-menu-modal-content p {
            font-size: 0.95em !important;
        }
    }
    
    </style>

    <script>

    // Fun√ß√µes globais para o sistema de dificuldade
    window.saveProgress = function(difficulty, wave) {
        const progressKey = `progress_${difficulty}`;
        localStorage.setItem(progressKey, wave.toString());

    };

    window.loadProgress = function(difficulty) {
        const progressKey = `progress_${difficulty}`;
        const progress = localStorage.getItem(progressKey);
        return progress ? parseInt(progress) : 0;
    };

    window.showDifficultyModal = function(isContinue = false) {

        const modal = document.getElementById('difficultyModal');
        const title = document.getElementById('difficultyModalTitle');
        
        if (!modal) {
            return;
        }
        
        if (isContinue) {
            title.textContent = 'Continuar Jogo';
            
            // Mostrar progresso de cada dificuldade
            const difficulties = ['easy', 'normal', 'hard'];
            difficulties.forEach(diff => {
                const progressElement = document.getElementById(`progress${diff.charAt(0).toUpperCase() + diff.slice(1)}`);
                const progress = window.loadProgress(diff);
                
                if (progress > 0) {
                    progressElement.textContent = `Onda ${progress}`;
                    progressElement.style.display = 'block';
                } else {
                    progressElement.style.display = 'none';
                }
            });
        } else {
            title.textContent = 'Selecione a Dificuldade';
            
            // Esconder progresso para novo jogo
            ['Easy', 'Normal', 'Hard'].forEach(diff => {
                const progressElement = document.getElementById(`progress${diff}`);
                progressElement.style.display = 'none';
            });
        }
        
        modal.style.setProperty('display', 'flex', 'important');
    };

    // Templates de caminho pr√©-definidos
    const PATH_TEMPLATES = {
        linear: {
            name: 'Linha Reta',
            description: 'Caminho simples em linha reta',
            path: [
                {x: 0, y: 7}, {x: 1, y: 7}, {x: 2, y: 7}, {x: 3, y: 7}, {x: 4, y: 7},
                {x: 5, y: 7}, {x: 6, y: 7}, {x: 7, y: 7}, {x: 8, y: 7}, {x: 9, y: 7},
                {x: 10, y: 7}, {x: 11, y: 7}, {x: 12, y: 7}, {x: 13, y: 7}, {x: 14, y: 7},
                {x: 15, y: 7}, {x: 16, y: 7}, {x: 17, y: 7}, {x: 18, y: 7}, {x: 19, y: 7}
            ]
        },
        zigzag: {
            name: 'Zigzag',
            description: 'Caminho em ziguezague',
            path: [
                // Primeira se√ß√£o horizontal
                {x: 0, y: 2}, {x: 1, y: 2}, {x: 2, y: 2}, {x: 3, y: 2}, {x: 4, y: 2},
                // Descida
                {x: 4, y: 3}, {x: 4, y: 4}, {x: 4, y: 5}, {x: 4, y: 6},
                // Segunda se√ß√£o horizontal
                {x: 5, y: 6}, {x: 6, y: 6}, {x: 7, y: 6}, {x: 8, y: 6}, {x: 9, y: 6},
                // Subida
                {x: 9, y: 5}, {x: 9, y: 4}, {x: 9, y: 3}, {x: 9, y: 2},
                // Terceira se√ß√£o horizontal
                {x: 10, y: 2}, {x: 11, y: 2}, {x: 12, y: 2}, {x: 13, y: 2}, {x: 14, y: 2},
                // Descida final
                {x: 14, y: 3}, {x: 14, y: 4}, {x: 14, y: 5}, {x: 14, y: 6},
                // Final
                {x: 15, y: 6}, {x: 16, y: 6}, {x: 17, y: 6}, {x: 18, y: 6}, {x: 19, y: 6}
            ]
        },
        maze: {
            name: 'Labirinto',
            description: 'Caminho complexo tipo labirinto',
            path: [
                // Entrada
                {x: 0, y: 12}, {x: 1, y: 12}, {x: 2, y: 12},
                // Subir
                {x: 2, y: 11}, {x: 2, y: 10}, {x: 2, y: 9}, {x: 2, y: 8},
                // Direita
                {x: 3, y: 8}, {x: 4, y: 8}, {x: 5, y: 8}, {x: 6, y: 8},
                // Descer
                {x: 6, y: 9}, {x: 6, y: 10}, {x: 6, y: 11}, {x: 6, y: 12},
                // Direita
                {x: 7, y: 12}, {x: 8, y: 12}, {x: 9, y: 12}, {x: 10, y: 12},
                // Subir
                {x: 10, y: 11}, {x: 10, y: 10}, {x: 10, y: 9}, {x: 10, y: 8}, {x: 10, y: 7},
                {x: 10, y: 6}, {x: 10, y: 5}, {x: 10, y: 4},
                // Direita
                {x: 11, y: 4}, {x: 12, y: 4}, {x: 13, y: 4}, {x: 14, y: 4},
                // Descer
                {x: 14, y: 5}, {x: 14, y: 6}, {x: 14, y: 7}, {x: 14, y: 8},
                // Direita final
                {x: 15, y: 8}, {x: 16, y: 8}, {x: 17, y: 8}, {x: 18, y: 8}, {x: 19, y: 8}
            ]
        }
    };

    // Fun√ß√£o para obter template de caminho baseado na dificuldade
    function getPathTemplateForDifficulty(difficulty) {
        switch (difficulty) {
            case 'easy':
                return PATH_TEMPLATES.maze; // Labirinto para f√°cil
            case 'normal':
                return PATH_TEMPLATES.zigzag; // Zigzag para normal
            case 'hard':
                return PATH_TEMPLATES.linear; // Linha reta para dif√≠cil
            default:
                return PATH_TEMPLATES.zigzag; // Padr√£o
        }
    }

    window.selectDifficulty = function(difficulty) {
        
        // Esconder modal de dificuldade
        const difficultyModal = document.getElementById('difficultyModal');
        if (difficultyModal) {
            difficultyModal.style.display = 'none';
        }
        
        // Esconder menu principal
        const mainMenu = document.getElementById('mainMenu');
        if (mainMenu) {
            mainMenu.style.display = 'none';
        }
        
        // Verificar se √© para continuar ou novo jogo
        const isContinue = document.getElementById('difficultyModalTitle').textContent === 'Continuar Jogo';
        
        // Aplicar configura√ß√µes de dificuldade
        const PRESETS = {
            easy: {
                name: 'F√°cil',
                config: {
                    initialHealth: 50,
                    initialGold: 150,
                    waveDelaySeconds: 8,
                    upgradeBaseCost: 50,
                    upgradePercentage: 50,
                    sellPercentage: 75,
                    enemyBaseHealth: 30,
                    enemyHealthIncrease: 8,
                    enemySpeed: 0.3,
                    enemyHealthMultiplier: 1.1,
                    enemySpeedMultiplier: 1.05,
                    enemiesPerWave: 5,
                    enemiesIncrease: 2,
                    goldMultiplier: 1.5
                }
            },
            normal: {
                name: 'Normal',
                config: {
                    initialHealth: 20,
                    initialGold: 100,
                    waveDelaySeconds: 5,
                    upgradeBaseCost: 75,
                    upgradePercentage: 50,
                    sellPercentage: 50,
                    enemyBaseHealth: 50,
                    enemyHealthIncrease: 15,
                    enemySpeed: 0.5,
                    enemyHealthMultiplier: 1.25,
                    enemySpeedMultiplier: 1.15,
                    enemiesPerWave: 8,
                    enemiesIncrease: 3,
                    goldMultiplier: 1
                }
            },
            hard: {
                name: 'Dif√≠cil',
                config: {
                    initialHealth: 10,
                    initialGold: 75,
                    waveDelaySeconds: 3,
                    upgradeBaseCost: 100,
                    upgradePercentage: 50,
                    sellPercentage: 25,
                    enemyBaseHealth: 80,
                    enemyHealthIncrease: 25,
                    enemySpeed: 0.8,
                    enemyHealthMultiplier: 1.4,
                    enemySpeedMultiplier: 1.25,
                    enemiesPerWave: 12,
                    enemiesIncrease: 4,
                    goldMultiplier: 0.8
                }
            }
        };

        const preset = PRESETS[difficulty];
        if (preset) {
            // Salvar a dificuldade selecionada
            localStorage.setItem('selectedDifficulty', difficulty);
            
            // Salvar configura√ß√µes
            const currentConfig = JSON.parse(localStorage.getItem('arqueiroConfig') || '{}');
            const newConfig = { ...currentConfig, ...preset.config };
            localStorage.setItem('arqueiroConfig', JSON.stringify(newConfig));
            
            // Aplicar template de caminho baseado na dificuldade
            const pathTemplate = getPathTemplateForDifficulty(difficulty);
            if (pathTemplate) {
                localStorage.setItem('enemyPath', JSON.stringify(pathTemplate.path));
                
                // Mostrar notifica√ß√£o sobre o template aplicado
                setTimeout(() => {
                    if (typeof window.uiSystem !== 'undefined' && window.uiSystem.showNotification) {
                        window.uiSystem.showNotification(`Template aplicado: ${pathTemplate.name}`, 'info');
                    }
                }, 1000);
            }
            

        }
        
        // Iniciar o jogo
        document.body.classList.add('game-running');
        
        if (isContinue) {
            // Continuar jogo com progresso salvo
            if (typeof window.iniciarModoContinuar !== 'undefined') {
                window.iniciarModoContinuar();
            } else {
                // Fallback: iniciar novo jogo
                if (typeof window.iniciarNovoJogo !== 'undefined') {
                    window.iniciarNovoJogo();
                }
            }
        } else {
            // Novo jogo
            if (typeof window.iniciarNovoJogo !== 'undefined') {
                window.iniciarNovoJogo();
            }
        }
        

    }

    // Menu inicial
    document.addEventListener('DOMContentLoaded', function() {
        const menu = document.getElementById('mainMenu');
        const btnPlay = document.getElementById('btnPlay');
        const btnContinue = document.getElementById('btnContinue');
        const btnConfig = document.getElementById('btnMenuConfig');
        const btnCredits = document.getElementById('btnMenuCredits');
        const creditsModal = document.getElementById('creditsModal');
        const closeCreditsModal = document.getElementById('closeCreditsModal');
        const debugButton = document.getElementById('debugButton');



                // Ao clicar em Jogar, mostrar modal de sele√ß√£o de dificuldade
        btnPlay.onclick = function() {
            
            const difficultyModal = document.getElementById('difficultyModal');
            const title = document.getElementById('difficultyModalTitle');
            
            if (difficultyModal) {
                // Resetar t√≠tulo para "Selecione a Dificuldade"
                title.textContent = 'Selecione a Dificuldade';
                
                // Esconder progresso para novo jogo
                ['Easy', 'Normal', 'Hard'].forEach(diff => {
                    const progressElement = document.getElementById(`progress${diff}`);
                    if (progressElement) {
                        progressElement.style.display = 'none';
                    }
                });
                
                difficultyModal.style.display = 'flex';
            }
        };
        
        // Ao clicar em Continuar, mostrar modal com progresso de cada dificuldade
        btnContinue.onclick = function() {
            
            const difficultyModal = document.getElementById('difficultyModal');
            const title = document.getElementById('difficultyModalTitle');
            
            if (difficultyModal) {
                // Mudar t√≠tulo para "Continuar Jogo"
                title.textContent = 'Continuar Jogo';
                
                // Mostrar progresso de cada dificuldade
                const difficulties = ['easy', 'normal', 'hard'];
                difficulties.forEach(diff => {
                    const progressElement = document.getElementById(`progress${diff.charAt(0).toUpperCase() + diff.slice(1)}`);
                    const progressKey = `progress_${diff}`;
                    const progress = parseInt(localStorage.getItem(progressKey) || '0');
                    
                    if (progress > 0) {
                        progressElement.textContent = `Onda ${progress}`;
                        progressElement.style.display = 'block';
                    } else {
                        progressElement.style.display = 'none';
                    }
                });
                
                // Mostrar modal
                difficultyModal.style.display = 'flex';
            }
        };
        
        // Verificar se deve mostrar o bot√£o "Continuar" (com delay para garantir que game.js foi carregado)
        setTimeout(function() {
            if (typeof window.adicionarBotaoContinuarMenu !== 'undefined') {
                window.adicionarBotaoContinuarMenu();
            }
        }, 100);
        // Configura√ß√µes: vai para config.html
        btnConfig.onclick = function() {
            window.location.href = 'config.html';
        };
        // Cr√©ditos: mostra modal
        if (btnCredits && creditsModal && closeCreditsModal) {
            // Garantir que o modal sempre inicie oculto
            creditsModal.classList.remove('show');
            
            btnCredits.onclick = function() {
                creditsModal.classList.add('show');
            };
            closeCreditsModal.onclick = function() {
                creditsModal.classList.remove('show');
            };
            // Fechar modal ao clicar fora
            creditsModal.onclick = function(e) {
                if (e.target === creditsModal) creditsModal.classList.remove('show');
            };
        }
        
        // Bot√£o Voltar ao Menu
        const btnBackToMenu = document.getElementById('btnBackToMenu');
        if (btnBackToMenu) {
            btnBackToMenu.onclick = function() {
                returnToMenu(true);
            };
        }
        
        // Fun√ß√£o para voltar ao menu principal
        window.returnToMenu = function(saveGame = false) {
            // Pausar o jogo se estiver rodando
            if (typeof window.gameSystem !== 'undefined' && window.gameSystem) {
                try {
                    // Tentar diferentes m√©todos de pausa
                    if (typeof window.gameSystem.pauseGame === 'function') {
                        window.gameSystem.pauseGame();
                    } else if (typeof window.gameSystem.pause === 'function') {
                        window.gameSystem.pause();
                    } else if (typeof window.gameSystem.stopGameLoop === 'function') {
                        window.gameSystem.stopGameLoop();
                    }

                } catch (error) {
                    // Erro ao pausar jogo
                }
            }
            
            // Mostrar o menu principal
            const mainMenu = document.getElementById('mainMenu');
            if (mainMenu) {
                mainMenu.style.display = 'flex';
                document.body.classList.remove('game-running');
            }
            
            // Salvar o jogo se solicitado
            if (saveGame && typeof window.gameSystem !== 'undefined' && window.gameSystem) {
                try {
                    if (typeof window.gameSystem.saveGame === 'function') {
                        window.gameSystem.saveGame();
                    }
                } catch (error) {
                    // Erro ao salvar jogo
                }
            }
            

        };
    });

    // Script para garantir que o menu principal apare√ßa ao carregar
    document.addEventListener('DOMContentLoaded', function() {

        
        // GARANTIR QUE O MENU PRINCIPAL ESTEJA VIS√çVEL AO CARREGAR A P√ÅGINA
        const mainMenu = document.getElementById('mainMenu');
        if (mainMenu) {
            // Sempre mostrar o menu ao carregar a p√°gina
            mainMenu.style.display = 'flex';
            document.body.classList.remove('game-running');

        }
        
        // Garantir que as habilidades especiais estejam vis√≠veis
        const arrowBtn = document.getElementById('btnArrowRain');
        const iceBtn = document.getElementById('btnIceStorm');
        
        if (arrowBtn) arrowBtn.style.display = 'flex';
        if (iceBtn) iceBtn.style.display = 'flex';
        
        // Garantir que os event listeners sejam configurados ap√≥s um delay
        setTimeout(() => {
            if (typeof window.fixEventListeners === 'function') {
                window.fixEventListeners();
            }
        }, 1000);
        
        // Garantir que as habilidades especiais estejam vis√≠veis
        setTimeout(() => {
            if (typeof window.setupSpecialSkillEventListeners === 'function') {
                window.setupSpecialSkillEventListeners();
            }
        }, 500);
    });

    </script>
</body>
</html> 