<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arqueiro - Tower Defense Infinito</title>
    <link rel="icon" type="image/x-icon" href="assets/imagen/favicon.ico">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="skill-tree.css">
    <link rel="stylesheet" href="config-style.css">
</head>
<body>
    <div class="game-container">
        <div class="top-panel">
            <div class="stats">
                <div class="stat">
                    <span class="label">Vida:</span>
                    <span id="health" class="value">20</span>
                </div>
                <div class="stat">
                    <span class="label">Ouro:</span>
                    <span id="gold" class="value">100</span>
                </div>
                <div class="stat">
                    <span class="label">Onda:</span>
                    <span id="wave" class="value">1</span>
                </div>
                <div class="stat">
                    <span class="label">Monstros:</span>
                    <span id="monsters" class="value">0/0</span>
                </div>
                <div class="stat">
                    <span class="label">Tempo:</span>
                    <span id="gameTime" class="value">00:00</span>
                </div>
                <div class="stat">
                    <span class="label">Pr√≥xima Onda:</span>
                    <span id="nextWaveTimer" class="value">--</span>
                </div>
                <div class="stat">
                    <span class="label">Pontos:</span>
                    <span id="score" class="value">0</span>
                </div>
            </div>
        </div>
        <div class="ui-panel">
            <div class="controls">
                <button id="start-wave" class="painel-lateral-btn onda">PR√ìXIMA ONDA</button>
                <button id="pause" class="painel-lateral-btn pausar">Pausar</button>
                <a href="config.html" class="painel-lateral-btn config" style="text-decoration:underline;">‚öôÔ∏è Configura√ß√µes</a>
                <button id="btnUpgrades" class="painel-lateral-btn upgrades">Upgrades</button>
            </div>
        </div>
        
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <div class="game-over" id="gameOver" style="display: none;">
            <div class="game-over-content">
                <h2>Game Over!</h2>
                <p>Voc√™ sobreviveu a <span id="final-wave">0</span> ondas!</p>
                <button id="restart" class="btn">Jogar Novamente</button>
            </div>
        </div>

        <!-- Painel de informa√ß√µes da torre -->
        <div class="tower-info-panel" id="towerInfoPanel" style="display: none;">
            <div class="tower-info-content">
                <h3 id="towerInfoTitle">Informa√ß√µes da Torre</h3>
                <div class="tower-stats">
                    <div class="stat">
                        <span class="label">N√≠vel:</span>
                        <span id="towerLevel">1</span>
                    </div>
                    <div class="stat">
                        <span class="label">Dano:</span>
                        <span id="towerDamage">15</span>
                    </div>
                    <div class="stat">
                        <span class="label">Alcance:</span>
                        <span id="towerRange">120</span>
                    </div>
                    <div class="stat">
                        <span class="label">Taxa de Tiro:</span>
                        <span id="towerFireRate">1000ms</span>
                    </div>
                </div>
                <div class="tower-actions">
                    <button id="upgradeTower" class="btn btn-success">‚¨ÜÔ∏è Evoluir (<span id="upgradeCost">50</span>)</button>
                    <button id="sellTower" class="btn btn-danger">üí∞ Vender (<span id="sellValue">25</span>)</button>
                    <button id="closeTowerInfo" class="btn btn-secondary">‚ùå Fechar</button>
                </div>
            </div>
        </div>

        <div class="footer-tower-bar" id="footerTowerBar">
            <!-- As op√ß√µes de torres ser√£o geradas dinamicamente pelo JS -->
        </div>
    </div>
    
    <script src="game.js" type="module"></script>
    <script src="config.js" type="module"></script>

    <div id="specialSkillsFixedBar">
        <button id="btnArrowRain" class="special-skill-btn" title="Chuva de Flechas (Recarga)">
            üèπ<br><span class="skill-label">Chuva de Flechas</span>
            <span class="skill-cooldown" id="arrowRainCooldown"></span>
        </button>
        <button id="btnIceStorm" class="special-skill-btn" title="Tempestade de Gelo (Recarga)" style="display:none;">
            ‚ùÑÔ∏è<br><span class="skill-label">Tempestade de Gelo</span>
            <span class="skill-cooldown" id="iceStormCooldown"></span>
        </button>
    </div>

    <div id="infoTooltip" class="info-tooltip" style="display:none;"></div>
    
    <!-- Bot√£o de Debug -->
    <div style="position: fixed; top: 10px; right: 10px; z-index: 1000;">
        <button id="debugButton" style="background: #333; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">
            Debug: OFF
        </button>
    </div>

    <!-- Painel/modal de upgrades -->
    <div id="upgradeModal" class="upgrade-modal" style="display:none;">
        <div class="upgrade-modal-content">
            <span id="closeUpgradeModal" class="close-modal">&times;</span>
            <h2>Upgrades Globais</h2>
            <div id="upgradePointsInfo">Pontos dispon√≠veis: <span id="upgradePoints">0</span></div>
            <div id="upgradeList"></div>
        </div>
    </div>

    <div id="mainMenu" class="main-menu-overlay">
        <div class="main-menu-content">
            <h1 class="main-menu-title">Arqueiro - Tower Defense Infinito</h1>
            <p style="color: #4fdfff; text-align: center; margin-bottom: 20px; font-size: 1.1em;">
                üéÆ Modo Infinito - Sobreviva o m√°ximo de ondas poss√≠vel!
            </p>
            <button id="btnPlay" class="main-menu-btn">Jogar</button>
            <button id="btnMenuConfig" class="main-menu-btn">Configura√ß√µes</button>
            <button id="btnMenuCredits" class="main-menu-btn">Cr√©ditos</button>
        </div>
    </div>

    <div id="creditsModal" class="main-menu-modal" style="display:none;">
        <div class="main-menu-modal-content">
            <span id="closeCreditsModal" class="main-menu-close">&times;</span>
            <h2>Cr√©ditos</h2>
            <p>Desenvolvido por [Seu Nome ou Equipe].<br>Inspirado em cl√°ssicos do g√™nero Tower Defense.<br><br>Projeto open-source para fins de estudo e divers√£o.</p>
        </div>
    </div>

    <style>
    .main-menu-overlay {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: linear-gradient(135deg, #181c24 80%, #4fdfff 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
    }
    .main-menu-content {
        background: #222b3a;
        border-radius: 18px;
        box-shadow: 0 8px 40px #000a;
        padding: 48px 36px 36px 36px;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-width: 320px;
    }
    .main-menu-title {
        color: #4fdfff;
        font-size: 2.2em;
        font-weight: bold;
        margin-bottom: 32px;
        text-shadow: 0 2px 12px #000a;
        letter-spacing: 1px;
    }
    .main-menu-btn {
        background: linear-gradient(135deg, #007bff, #0056b3);
        color: white;
        border: none;
        border-radius: 8px;
        padding: 16px 40px;
        margin: 10px 0;
        font-size: 1.2em;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 2px 12px #0004;
        transition: background 0.2s, transform 0.2s;
    }
    .main-menu-btn:hover {
        background: linear-gradient(135deg, #4fdfff, #007bff);
        transform: translateY(-2px) scale(1.04);
    }
    .main-menu-modal {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0,0,0,0.7);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
    }
    .main-menu-modal-content {
        background: #fff;
        color: #222b3a;
        border-radius: 12px;
        padding: 32px 28px;
        min-width: 300px;
        max-width: 90vw;
        box-shadow: 0 8px 32px #000a;
        position: relative;
        text-align: center;
    }
    .main-menu-close {
        position: absolute;
        top: 12px;
        right: 18px;
        font-size: 2em;
        color: #4fdfff;
        cursor: pointer;
    }
    </style>

    <script>
    // Fun√ß√µes de debug globais
    window.debugMode = false;
    window.toggleDebug = function() {
        window.debugMode = !window.debugMode;
        console.log(`Modo debug ${window.debugMode ? 'ativado' : 'desativado'}`);
        
        // Atualizar texto do bot√£o
        const debugButton = document.getElementById('debugButton');
        if (debugButton) {
            debugButton.textContent = `Debug: ${window.debugMode ? 'ON' : 'OFF'}`;
            debugButton.style.background = window.debugMode ? '#ff6600' : '#333';
        }
        
        if (window.debugMode) {
            console.log('Para testar a explos√£o do canh√£o, coloque uma torre canh√£o e observe os logs no console');
            console.log('Use testExplosion(x, y, radius) para testar explos√µes manualmente');
        }
    };

    // Fun√ß√£o para testar explos√£o manualmente
    window.testExplosion = function(x, y, radius) {
        if (!window.gameSystem || !window.gameSystem.gameState) {
            console.log('Sistema de jogo n√£o inicializado');
            return;
        }
        
        console.log(`Testando explos√£o em (${x}, ${y}) com raio ${radius}`);
        
        // Simular uma explos√£o
        let hitCount = 0;
        const enemies = [...window.gameSystem.gameState.enemies];
        
        for (let enemy of enemies) {
            if (!enemy || !enemy.health || enemy.health <= 0 || enemy.isRemoved) continue;
            
            const dx = enemy.x - x;
            const dy = enemy.y - y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance <= radius) {
                hitCount++;
                console.log(`‚úÖ Teste: inimigo atingido a ${distance.toFixed(1)}px`);
            } else {
                console.log(`‚ùå Teste: inimigo fora da √°rea (${distance.toFixed(1)}px > ${radius}px)`);
            }
        }
        
        console.log(`üéØ Teste: ${hitCount} inimigos seriam atingidos`);
    };

    // Menu inicial
    document.addEventListener('DOMContentLoaded', function() {
        const menu = document.getElementById('mainMenu');
        const btnPlay = document.getElementById('btnPlay');
        const btnConfig = document.getElementById('btnMenuConfig');
        const btnCredits = document.getElementById('btnMenuCredits');
        const creditsModal = document.getElementById('creditsModal');
        const closeCreditsModal = document.getElementById('closeCreditsModal');
        const debugButton = document.getElementById('debugButton');

        // Bot√£o de debug
        if (debugButton) {
            debugButton.addEventListener('click', function() {
                window.toggleDebug();
            });
        }

        // Ao clicar em Jogar, esconde o menu e inicia o jogo
        btnPlay.onclick = function() {
            menu.style.display = 'none';
            // Iniciar o game loop se ainda n√£o foi iniciado
            if (typeof window.gameSystem !== 'undefined' && window.gameSystem && !window.gameSystem.isRunning) {
                window.gameSystem.startGameLoop();
            } else if (typeof gameSystem !== 'undefined' && gameSystem && !gameSystem.isRunning) {
                gameSystem.startGameLoop();
            }
        };
        // Configura√ß√µes: vai para config.html
        btnConfig.onclick = function() {
            window.location.href = 'config.html';
        };
        // Cr√©ditos: mostra modal
        btnCredits.onclick = function() {
            creditsModal.style.display = 'flex';
        };
        closeCreditsModal.onclick = function() {
            creditsModal.style.display = 'none';
        };
        // Fechar modal ao clicar fora
        creditsModal.onclick = function(e) {
            if (e.target === creditsModal) creditsModal.style.display = 'none';
        };
    });


    </script>
</body>
</html> 